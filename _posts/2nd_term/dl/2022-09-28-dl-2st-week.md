---
layout: post
title:  ë”¥ëŸ¬ë‹ 2ì£¼ì°¨ - ë°ì´í„°ì˜ ê¸°ë³¸ê³¼ í…ì„œ
date:   2022-09-28 00:00:00
author: keonju
categories: ["2nd_term"]
tags: ["dl"]
---

# 2ì£¼ì°¨ëŠ” ë¬´ì—‡ì„ ë°°ì› ë‚˜ìš”

1. Tensor ë§Œë“¤ê¸°  
2. Tensor ë°”ê¾¸ê¸°
3. Tensor ì—°ì‚°í•˜ê¸°
4. DataFrameì„ Tensorë¡œ ë§Œë“¤ê¸°
5. ì‹¤ìŠµ  
6. ë§ˆì¹˜ë©°

ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤!   
ì§€ë‚œì£¼ì— ë°°ì› ë˜ Numpyì™€ ë¹„ìŠ·í•œ Tensorì´ì§€ë§Œ ë” ë§ì€ ë‚´ìš©ì„ ë‹¤ë¤˜ìŠµë‹ˆë‹¤!  
ë‚´ìš©ì´ ë§ì´ ëŠ˜ì–´ë‚˜ ë§ì´ í˜ë“¤ì—ˆì§€ë§Œ ë‹¤ë“¤ ì—´ì‹­íˆ ì°¸ì—¬í•´ì£¼ì…¨ìŠµë‹ˆë‹¤..! (ë¶„ëŸ‰ ì¡°ì ˆ ì‹¤íŒ¨í•œ ì‚¬ëŒ ë°˜ì„±ì¤‘.. ğŸ¥º)  
ì´ë²ˆì—ë„ ì¤‘ê°„ì¤‘ê°„ ê³¼ì œë¡œ ë” ê³µë¶€í•œ ë‚´ìš©ë“¤ë„ ìˆìœ¼ë‹ˆ ì°¸ê³ í•´ì£¼ì„¸ìš”!  


í•¨ê»˜ ê¸°ë³¸ ë°ì´í„° êµ¬ì¡°ì¸ í…ì„œë¥¼ ì‹œì‘ìœ¼ë¡œ ë³¸ê²©ì ìœ¼ë¡œ ë”¥ëŸ¬ë‹ ê¸°ì´ˆë¥¼ ë‹¤ì ¸ë³´ì•„ìš”!!  

<br/> 
<br/> 
<br>

---

## 1. Tensor ë§Œë“¤ê¸°
Tensorë¥¼ ë§Œë“¤ê³  Tensorì˜ ìš”ì†Œë“¤ì„ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ë¨¼ì € ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.   

<br/> 
<br/> 
  

### Tensor ìƒì„±
- arange : ê°™ì€ ê°„ê²©ì˜ 1ì°¨ì› í…ì„œ
- zeros : 0ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ
- ones : 1ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ
- randn : 0~1ì˜ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ


```python
import torch
```


```python
x = torch.arange(12, dtype=torch.float32)
x
```




    tensor([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])




```python
torch.zeros((2, 3, 4))
```




    tensor([[[0., 0., 0., 0.],
             [0., 0., 0., 0.],
             [0., 0., 0., 0.]],
    
            [[0., 0., 0., 0.],
             [0., 0., 0., 0.],
             [0., 0., 0., 0.]]])




```python
torch.ones((2, 3, 4))
```




    tensor([[[1., 1., 1., 1.],
             [1., 1., 1., 1.],
             [1., 1., 1., 1.]],
    
            [[1., 1., 1., 1.],
             [1., 1., 1., 1.],
             [1., 1., 1., 1.]]])




```python
torch.randn(3, 4)
```




    tensor([[-1.4006,  0.6990, -0.3430, -0.4306],
            [ 1.2131, -0.1662, -0.8585,  0.0919],
            [ 1.5555, -1.7267, -1.5563,  0.0836]])




```python
torch.tensor([[2, 1, 4, 3], [1, 2, 3, 4], [4, 3, 2, 1]])
```




    tensor([[2, 1, 4, 3],
            [1, 2, 3, 4],
            [4, 3, 2, 1]])



### Tensor í˜•íƒœ íŒŒì•…í•˜ê¸°  

- numel : element ìˆ˜ íŒŒì•…
- shape : Tensor í˜•íƒœ íŒŒì•…
- dtype : ë°ì´í„° íƒ€ì… íŒŒì•…


```python
x.numel()
```




    12




```python
x.shape
```




    torch.Size([12])




```python
x.dtype
```




    torch.float32

### ì¤€ì„ ) Tensorì˜ íƒ€ì…ì„ ì•Œë ¤ì£¼ì„¸ìš”.  

torch.Tensor()ì˜ ê¸°ë³¸ í…ì„œ íƒ€ì…ì€ torch.FloatTensor ì´ë‹¤.  

í…ì„œ íƒ€ì…ì€ ì´ˆê¸°í™” í•  ë•Œ ì§€ì •í•˜ê±°ë‚˜ ë‚˜ì¤‘ì— ë‹¤ë¥¸ íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.  
- ì´ˆê¸°í™” ì‹œ íƒ€ì… ì§€ì •  
1) FloatTensor ê°™ì€ íŠ¹ì • í…ì„œ íƒ€ì…ì˜ ìƒì„±ìë¥¼ ì§ì ‘ í˜¸ì¶œ ë˜ëŠ” íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ ì‚¬ìš©  
2) torch.Tensor()ì™€ í•¨ê»˜ dtype ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©  



```python
import torch

def describe(x):
    print("íƒ€ì…: {}".format(x.type()))
    print("ê°’: {}".format(x))
```


```python
x = torch.FloatTensor([[1,2,3],[4,5,6]])
describe(x) # floatí˜•
```

    íƒ€ì…: torch.FloatTensor
    ê°’: tensor([[1., 2., 3.],
            [4., 5., 6.]])
    


```python
x = torch.LongTensor([[1,2,3],[4,5,6]])
describe(x) # longí˜•
```

    íƒ€ì…: torch.LongTensor
    ê°’: tensor([[1, 2, 3],
            [4, 5, 6]])
    


```python
x = torch.ShortTensor([[1,2,3],[4,5,6]])
describe(x) # shortí˜•
```

    íƒ€ì…: torch.ShortTensor
    ê°’: tensor([[1, 2, 3],
            [4, 5, 6]], dtype=torch.int16)
    


```python
x = x.double()
describe(x) # íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ
```

    íƒ€ì…: torch.DoubleTensor
    ê°’: tensor([[1., 2., 3.],
            [4., 5., 6.]], dtype=torch.float64)
    


```python
x = x.int()
describe(x) # íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ
```

    íƒ€ì…: torch.IntTensor
    ê°’: tensor([[1, 2, 3],
            [4, 5, 6]], dtype=torch.int32)
    

#### ì—¬ê¸°ê¹Œì§€ëŠ” ì•ì„œ ì–¸ê¸‰í–ˆë˜ ì²« ë²ˆì§¸ ë°©ì‹ìœ¼ë¡œ tensorì˜ íƒ€ì…ì„ ì§€ì •í–ˆë‹¤ 
- FloatTensor ê°™ì€ íŠ¹ì • í…ì„œ íƒ€ì…ì˜ ìƒì„±ìë¥¼ ì§ì ‘ í˜¸ì¶œ ë˜ëŠ” íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ ì‚¬ìš©  


```python
y = torch.tensor([[1,2,3],[4,5,6],[7,8,9]], dtype = torch.float64)
describe(y)
```

    íƒ€ì…: torch.DoubleTensor
    ê°’: tensor([[1., 2., 3.],
            [4., 5., 6.],
            [7., 8., 9.]], dtype=torch.float64)
    


```python
y = torch.tensor([[1,2,3],[4,5,6],[7,8,9]], dtype = torch.int64)
describe(y)
```

    íƒ€ì…: torch.LongTensor
    ê°’: tensor([[1, 2, 3],
            [4, 5, 6],
            [7, 8, 9]])
    

#### ì—¬ê¸°ê¹Œì§€ëŠ” ë‘ ë²ˆì¨° ë°©ì‹ì„ ì´ìš©í–ˆë‹¤.  


```python
# shape ë˜ëŠ” size()ë¥¼ í†µí•´ í…ì„œì˜ í¬ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
y.shape
```




    torch.Size([3, 3])




```python
y.size()
```




    torch.Size([3, 3])



![20220928_233616](https://user-images.githubusercontent.com/54880474/192807948-44620bd9-6991-476e-adfe-55a6dd7464af.png)

##### ë‹¤ìŒê³¼ ê°™ì´ ê° ë°ì´í„°í˜• ë³„ë¡œ ë°ì´í„° íƒ€ì…ì´ ì •í•´ì ¸ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.


### ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±  

ë„˜íŒŒì´ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±, ê°’ë„ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
print(x[-1])
print(x[1:3])
```

    tensor(11.)
    tensor([1., 2.])
    


```python
x[1] = 17
x
```




    tensor([ 0., 17.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])




```python
x[:2] = 12
x
```




    tensor([12., 12.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])

<br>
<br>
<br>
---

## 2. Tensor ë°”ê¾¸ê¸°
Tensor í˜•íƒœë¥¼ ë³€í™˜í•˜ê³  Tensorì„ í•©ì¹˜ê³ , ë‚˜ëˆ„ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.  
<br/>

### Tensor í˜•íƒœ ë³€í™˜
- reshape : contiguousí•˜ì§€ ì•Šì„ ë•Œë„ ë³€í™˜ ê°€ëŠ¥!
- view : contiguousí•˜ì§€ ì•Šìœ¼ë©´ ë³€í™˜ ë¶ˆê°€ëŠ¥!
- squeeze : 1ì¸ ì°¨ì› ì œê±°
- unsqueeze : 1ì¸ ì°¨ì› ì¶”ê°€
- transpose : ì „ì¹˜ í–‰ë ¬



```python
X = x.reshape(3, 4)
X
```




    tensor([[12., 12.,  2.,  3.],
            [ 4.,  5.,  6.,  7.],
            [ 8.,  9., 10., 11.]])




```python
import numpy as np

t = np.array([[[0, 1, 2],
               [3, 4, 5]],
              [[6, 7, 8],
               [9, 10, 11]]])
ft = torch.FloatTensor(t)
```


```python
print(ft.shape)
```

    torch.Size([2, 2, 3])
    

-1ì€ ë‹¤ë¥¸ ì°¨ì›ìœ¼ë¡œë¶€í„° ë§ì¶°ì„œ ë³€í™˜ë©ë‹ˆë‹¤.  


```python
print(ft.view([-1, 3]))
print(ft.view([-1, 3]).shape)
```

    tensor([[ 0.,  1.,  2.],
            [ 3.,  4.,  5.],
            [ 6.,  7.,  8.],
            [ 9., 10., 11.]])
    torch.Size([4, 3])
    


```python
print(ft.view([-1, 1, 3]))
print(ft.view([-1, 1, 3]).shape)
```

    tensor([[[ 0.,  1.,  2.]],
    
            [[ 3.,  4.,  5.]],
    
            [[ 6.,  7.,  8.]],
    
            [[ 9., 10., 11.]]])
    torch.Size([4, 1, 3])
    


```python
ft = torch.FloatTensor([[0], [1], [2]])
print(ft)
print(ft.shape)
```

    tensor([[0.],
            [1.],
            [2.]])
    torch.Size([3, 1])
    

squeezeë¥¼ í†µí•´ 2ì°¨ì›ì—ì„œ 1ì°¨ì›ìœ¼ë¡œ ë³€í˜•ë˜ì—ˆìŠµë‹ˆë‹¤.


```python
print(ft.squeeze())
print(ft.squeeze().shape)
```

    tensor([0., 1., 2.])
    torch.Size([3])
    


```python
ft = torch.Tensor([0, 1, 2])
print(ft.shape)
```

    torch.Size([3])
    

ë‹¤ì‹œ unsqueezeë¥¼ í†µí•´ 2ì°¨ì›ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.


```python
print(ft.unsqueeze(0))
print(ft.unsqueeze(0).shape)
```

    tensor([[0., 1., 2.]])
    torch.Size([1, 3])
    


```python
print(ft.view(1, -1))
print(ft.view(1, -1).shape)
```

    tensor([[0., 1., 2.]])
    torch.Size([1, 3])
    


```python
print(ft.unsqueeze(1))
print(ft.unsqueeze(1).shape)
```

    tensor([[0.],
            [1.],
            [2.]])
    torch.Size([3, 1])
    


```python
print(ft.unsqueeze(-1))
print(ft.unsqueeze(-1).shape)
```

    tensor([[0.],
            [1.],
            [2.]])
    torch.Size([3, 1])
    

TransposeëŠ” í–‰ê³¼ ì—´ì„ ë°”ê¿”ì£¼ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.  


```python
A = torch.arange(6).reshape(3, 2)
A
```




    tensor([[0, 1],
            [2, 3],
            [4, 5]])




```python
A.T
```




    tensor([[0, 2, 4],
            [1, 3, 5]])




```python
A = torch.tensor([[1, 2, 3], [2, 0, 4], [3, 4, 5]])
A == A.T
```




    tensor([[True, True, True],
            [True, True, True],
            [True, True, True]])

### í˜ ) contiguous()ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.

contiguous()ëŠ” í…ì„œë¥¼ numpyê°™ì€ ë°©ì‹ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì„ ë§í•©ë‹ˆë‹¤.  
numpyëŠ” ì¸ì ‘í•œ ë°°ì—´ì˜ ë°ì´í„°ëŠ” ì¸ì ‘í•œ ë©”ëª¨ë¦¬ì— ì €ì¥í•¨ìœ¼ë¡œì¨ ì ‘ê·¼ì†ë„ë‚˜ transposeì†ë„ê°€ ë§¤ìš° ë¹ ë¥´ê²Œë©ë‹ˆë‹¤.  
ë³´í†µ view(),narrow(),expand(),tranpose()ë¥¼ ì¨ì„œ í…ì„œëª¨ì–‘ì„ ê³ ì¹ ë•Œ contiguousí˜•ì‹ì´ ìš”êµ¬ë˜ëŠ”ë°  
ì˜ˆë¥¼ ë“¤ì–´ view()ê°™ì€ ê²½ìš°ëŠ” reshapeë‚˜ resizeì™€ëŠ” ë‹¤ë¥´ê²Œ ì–´ë–¤ ê²½ìš°ì—ë„ ë©”ëª¨ë¦¬ ë³µì‚¬ì—†ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.  
ë”°ë¼ì„œ contiguousí˜•ì‹ì´ ì•„ë‹ë•ŒëŠ” í…ì„œëª¨ì–‘ì„ ê³ ì¹ ìˆ˜ ì—†ê²Œë˜ê³  ëŸ°íƒ€ì„ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.  

ì½”ë“œë¥¼ í†µí•´ì„œ contiguousì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.  

```python
import torch

a = torch.randn(3,4)
print(a.is_contiguous())
a.transpose_(0,1)
b = torch.randn(4,3)
print(a)
print(b.is_contiguous())
print(b)
```

    True
    tensor([[ 1.0009,  0.1026, -1.1214],
            [ 0.7532,  2.0344,  1.4519],
            [-0.5742, -1.3162,  1.5134],
            [ 1.2349, -1.2356,  1.7235]])
    True
    tensor([[-0.2183,  2.2920, -0.2232],
            [ 0.0463, -0.4723,  0.8091],
            [-0.7852,  1.6145, -0.2895],
            [ 0.5062,  0.6791,  1.3657]])
    
ëœë¤ìœ¼ë¡œ aì™€ bë¼ëŠ” Tensorë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.  
aì™€ bëŠ” í˜•ì„±ë˜ì–´ì¡Œì„ ë•Œ, is_contiguousë¥¼ í†µí•´ì„œ ë‘ Tensor ëª¨ë‘ contiguousí•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ê·¸ëŸ¼ ì•„ë˜ì˜ ì½”ë“œë¥¼ í†µí•´ tranpose ì´í›„ aì™€ bì˜ ì°¨ì´ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.  

```python
for i in range(4):
  for j in range(3):
    print(a[i][j].data_ptr())
  
print('*' * 10)

for i in range(4):
  for j in range(3):
    print(b[i][j].data_ptr())    
```

    1863763599552
    1863763599568
    1863763599584
    1863763599556
    1863763599572
    1863763599588
    1863763599560
    1863763599576
    1863763599592
    1863763599564
    1863763599580
    1863763599596
    **********
    1863763604288
    1863763604292
    1863763604296
    1863763604300
    1863763604304
    1863763604308
    1863763604312
    1863763604316
    1863763604320
    1863763604324
    1863763604328
    1863763604332
    
ê° í…ì„œ ìš”ì†Œì˜ ì£¼ì†Œë¥¼ ì¶”ì¶œí•˜ì˜€ìŠµë‹ˆë‹¤.  
ê° ë°ì´í„° íƒ€ì…ì¸ torch.float32 ìë£Œí˜•ì€ 4ë°”ì´íŠ¸ ì´ë¯€ë¡œ,  
ë©”ëª¨ë¦¬ 1ì¹¸ ë‹¹ ì£¼ì†Œ ê°’ì´ 4ì”© ì¦ê°€í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
bëŠ” í•œ ì¤„ì— 4ì”© ê°’ì´ ì¦ê°€í•˜ì§€ë§Œ aëŠ” ê·¸ë ‡ì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ì•„ë˜ì½”ë“œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.  

```python
print(a.stride())
print(b.stride())
print(a.is_contiguous())
print(b.is_contiguous())
```

    (1, 4)
    (3, 1)
    False
    True
    
aê°€ tranposeëœ ì´í›„ì— falseë¡œ ë°”ë€ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ì¦‰ bëŠ” ì˜¤ë¥¸ìª½ ë°©í–¥ìœ¼ë¡œ ìë£Œê°€ ìˆœì„œëŒ€ë¡œ ì €ì¥ë¨ì— ë¹„í•´  
aëŠ” tranpose ì—°ì‚°ì„ ê±°ì¹˜ë©° axis = 1ì¸ ì•„ë˜ ë°©í–¥ìœ¼ë¡œ ìë£Œê°€ ì €ì¥ë˜ê³  ìˆìŠµë‹ˆë‹¤.  
strideë©”ì†Œë“œë¥¼ ë³´ë©´, ë°ì´í„°ì˜ ì €ì¥ ë°©í–¥ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
aì˜ stride ê²°ê³¼ê°’ì„ í•´ì„í•˜ìë©´  
a[0][0]->a[1][0]ìœ¼ë¡œ ì¦ê°€í•  ë•ŒëŠ” ìë£Œ 1ê°œ ë§Œí¼ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ì´ë™ë˜ê³ ,  
a[0][0]->a[0][1]ìœ¼ë¡œ ì¦ê°€í•  ë•ŒëŠ” ìë£Œ 4ê°œ ë§Œí¼ì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ë°”ë€ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.  
ê·¸ë˜ì„œ aì˜ forë¬¸ ê²°ê³¼ì˜ ì²˜ìŒ 3ì¤„ì—ëŠ” ë©”ëª¨ë¦¬ê°€ 16ì”© ì¦ê°€í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

í˜„ì¬ tranpose ëœ a ê°™ì€ ê²½ìš°ëŠ” contiguousëŠ” Falseë¡œ ìë£Œë¥¼ ìˆœì„œëŒ€ë¡œ ì €ì¥í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.  
ì´ìƒíƒœì—ì„œ reshape,resizeê°€ ì•„ë‹Œ viewë¥¼ ì¨ë³´ê² ìŠµë‹ˆë‹¤.  

```python
print(a.is_contiguous())
a.view(2,6)
```

    False
    


    ---------------------------------------------------------------------------

    RuntimeError                              Traceback (most recent call last)

    ~\AppData\Local\Temp/ipykernel_26164/2291854614.py in <module>
          1 print(a.is_contiguous())
    ----> 2 a.view(2,6)
    

    RuntimeError: view size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.

ì´ë ‡ê²Œ RuntimeErrorê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  

ê·¸ëŸ¼ aê°€ viewë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ contiguous()ë¥¼ í†µí•´ì„œ ë°”ê¾¸ì–´ë³´ê² ìŠµë‹ˆë‹¤.  

```python
a = a.contiguous()
print(a.is_contiguous())
a.view(2,6)
```

    True
    




    tensor([[ 1.0009,  0.1026, -1.1214,  0.7532,  2.0344,  1.4519],
            [-0.5742, -1.3162,  1.5134,  1.2349, -1.2356,  1.7235]])

í˜„ì¬ëŠ” aê°€ contigious True í˜•íƒœë¡œ ë°”ë€Œì—ˆê³  viewê°€ ì ìš©ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.   


ê°ì‚¬í•©ë‹ˆë‹¤.  
 


### Tensor í•©ì¹˜ê¸°, ë‚˜ëˆ„ê¸°

- cat, stacking : í…ì„œë¥¼ í•©ì¹©ë‹ˆë‹¤.  
- chunk, split : í…ì„œë¥¼ ë‚˜ëˆ ì¤ë‹ˆë‹¤.    

<br/>

#### Tensor í•©ì¹˜ê¸°
dimì„ í†µí•´ í•©ì³ì¤„ ì¶•ì„ ì •í•´ì¤ë‹ˆë‹¤.  

catì€ ì£¼ì–´ì§„ ì°¨ì›ì„ ê¸°ì¤€ìœ¼ë¡œ, stackì€ ìƒˆë¡œìš´ ì°¨ì›ìœ¼ë¡œ ì£¼ì–´ì§„ í…ì„œë¥¼ ë¶™ì…ë‹ˆë‹¤.  


```python
x = torch.FloatTensor([[1, 2], [3, 4]])
y = torch.FloatTensor([[5, 6], [7, 8]])
```


```python
print(torch.cat([x, y], dim=0))
```

    tensor([[1., 2.],
            [3., 4.],
            [5., 6.],
            [7., 8.]])
    


```python
print(torch.cat([x, y], dim=1))
```

    tensor([[1., 2., 5., 6.],
            [3., 4., 7., 8.]])
    


```python
print(torch.stack([x, y]))
```

    tensor([[[1., 2.],
             [3., 4.]],
    
            [[5., 6.],
             [7., 8.]]])
    

catì€ (4,2)ì˜ í¬ê¸°ë¥¼, stackì€ (2,2,2)ì˜ í¬ê¸°ë¥¼ ê°–ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆìŠµë‹ˆë‹¤.


```python
x = torch.FloatTensor([1, 4])
y = torch.FloatTensor([2, 5])
z = torch.FloatTensor([3, 6])
```


```python
print(torch.stack([x, y, z]))
```

    tensor([[1., 4.],
            [2., 5.],
            [3., 6.]])
    


```python
print(torch.cat([x.unsqueeze(0), y.unsqueeze(0), z.unsqueeze(0)], dim=0))
```

    tensor([[1., 4.],
            [2., 5.],
            [3., 6.]])
    


```python
print(torch.stack([x, y, z], dim=1))
```

    tensor([[1., 2., 3.],
            [4., 5., 6.]])
    

#### Tensor ë‚˜ëˆ„ê¸°

chunkëŠ” nê°œì˜ ê·¸ë£¹ì„ ë§Œë“¤ê³ , splitì€ nê°œì˜ ë°ì´í„°ê°€ ìˆëŠ” ê·¸ë£¹ì„ ë§Œë“­ë‹ˆë‹¤.  


```python
# 3ê°œì˜ ê·¸ë£¹ì„ ë§Œë“œëŠ” chunk
tensor = torch.rand(3,6)
print(tensor)

t1, t2, t3 = torch.chunk(tensor, 3, dim=1)

print(t1)
print(t2)
print(t3)
```

    tensor([[0.3124, 0.3670, 0.4461, 0.3799, 0.4759, 0.7645],
            [0.9245, 0.2099, 0.4981, 0.2253, 0.1432, 0.4176],
            [0.3214, 0.4409, 0.4165, 0.0611, 0.4758, 0.6666]])
    tensor([[0.3124, 0.3670],
            [0.9245, 0.2099],
            [0.3214, 0.4409]])
    tensor([[0.4461, 0.3799],
            [0.4981, 0.2253],
            [0.4165, 0.0611]])
    tensor([[0.4759, 0.7645],
            [0.1432, 0.4176],
            [0.4758, 0.6666]])
    


```python
# 3ê°œì˜ ë°ì´í„°ê°€ ìˆëŠ” ê·¸ë£¹ì„ ë§Œë“œëŠ” split (2ê°œì˜ tensorë¡œ ë¶„ë¦¬)
tensor = torch.rand(3,6)
print(tensor)

t1, t2 = torch.split(tensor, 3, dim=1)

print(t1)
print(t2)
```

    tensor([[0.5875, 0.2308, 0.4805, 0.2589, 0.5313, 0.8857],
            [0.9570, 0.9571, 0.2845, 0.7530, 0.4334, 0.5157],
            [0.6430, 0.3617, 0.3446, 0.9501, 0.4462, 0.8290]])
    tensor([[0.5875, 0.2308, 0.4805],
            [0.9570, 0.9571, 0.2845],
            [0.6430, 0.3617, 0.3446]])
    tensor([[0.2589, 0.5313, 0.8857],
            [0.7530, 0.4334, 0.5157],
            [0.9501, 0.4462, 0.8290]])
    
<br>
<br>
<br>

---

## 3. Tensor ì—°ì‚°í•˜ê¸°

Tensor ê°’ë“¤ë¼ë¦¬ì˜ ì—°ì‚°, Tensorê°„ì˜ ì—°ì‚°ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.  

<br/>  

### ê¸°ë³¸ ì—°ì‚°  
- +, -, *, / : ê°™ì€ ìœ„ì¹˜ë¼ë¦¬ ì—°ì‚°
- sum, cumsum : í•©ê³¼ ëˆ„ì í•©
- mean, std : í†µê³„ê°’
- exp : ì§€ìˆ˜í•©ìˆ˜


```python
x = torch.tensor([1.0, 2, 4, 8])
y = torch.tensor([2, 2, 2, 2])
x + y, x - y, x * y, x / y, x ** y
```




    (tensor([ 3.,  4.,  6., 10.]),
     tensor([-1.,  0.,  2.,  6.]),
     tensor([ 2.,  4.,  8., 16.]),
     tensor([0.5000, 1.0000, 2.0000, 4.0000]),
     tensor([ 1.,  4., 16., 64.]))




```python
x == y
```




    tensor([False,  True, False, False])




```python
x.sum()
```




    tensor(15.)




```python
torch.exp(X)
```




    tensor([[1.6275e+05, 1.6275e+05, 7.3891e+00, 2.0086e+01],
            [5.4598e+01, 1.4841e+02, 4.0343e+02, 1.0966e+03],
            [2.9810e+03, 8.1031e+03, 2.2026e+04, 5.9874e+04]])




```python
A
```




    tensor([[1, 2, 3],
            [2, 0, 4],
            [3, 4, 5]])



axisë¥¼ í†µí•´ ì—°ì‚°í•´ì¤„ í–‰, ì—´ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤.  


```python
A.shape, A.sum(axis=0)
```




    (torch.Size([3, 3]), tensor([ 6,  6, 12]))




```python
A.shape, A.sum(axis=1)
```




    (torch.Size([3, 3]), tensor([ 6,  6, 12]))



keepdimsë¥¼ í†µí•´ ì°¨ì›ì„ ìœ ì§€í•˜ë©° ì—°ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  


```python
sum_A = A.sum(axis=1, keepdims=True)
sum_A, sum_A.shape
```




    (tensor([[ 6],
             [ 6],
             [12]]), torch.Size([3, 1]))




```python
A / sum_A
```




    tensor([[0.1667, 0.3333, 0.5000],
            [0.3333, 0.0000, 0.6667],
            [0.2500, 0.3333, 0.4167]])




```python
A.cumsum(axis=0)
```




    tensor([[ 1,  2,  3],
            [ 3,  2,  7],
            [ 6,  6, 12]])


### ì •ì¤€ ) in-place ì—°ì‚°ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”

ìš°ì„  2X2í˜•íƒœì˜ í…ì„œë¥¼ ë§Œë“¤ì–´ ë³€ìˆ˜ xì— ì €ì¥í•©ë‹ˆë‹¤.  

```python
x = torch.FloatTensor([[1, 2], [3, 4]])
```

ê³±í•˜ê¸° ì—°ì‚°ì„ í•œ ê°’ê³¼ ê¸°ì¡´ì˜ ê°’ì„ ì¶œë ¥í•˜ë©´?   

```python
print(x.mul(2.)) # ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ ì¶œë ¥
print(x) # ê¸°ì¡´ì˜ ê°’ ì¶œë ¥
```
        tensor([[2., 4.],
                [6., 8.]])
        tensor([[1., 2.],
                [3., 4.]])


ì²«ë²ˆì§¸ ì¶œë ¥ì€ ê³±í•˜ê¸° 2ê°€ ìˆ˜í–‰ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê³ , ë‘ë²ˆì§¸ ì¶œë ¥ì€ ê¸°ì¡´ì˜ ê°’ì´ ê·¸ëŒ€ë¡œ ì¶œë ¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í–ˆì§€ë§Œ ì´ë¥¼ xì—ë‹¤ê°€ ë‹¤ì‹œ ì €ì¥í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ, ê³±í•˜ê¸° ì—°ì‚°ì„ í•˜ë”ë¼ë„ ê¸°ì¡´ì˜ ê°’ xëŠ” ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ë‹¹ì—°í•©ë‹ˆë‹¤.  

ê·¸ëŸ°ë° ì—°ì‚° ë’¤ì— _ë¥¼ ë¶™ì´ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ê¸°ì¡´ì˜ ê°’ì„ ë®ì–´ì“°ê¸° í•©ë‹ˆë‹¤.  


```python
print(x.mul_(2.))  # ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ ë³€ìˆ˜ xì— ê°’ì„ ì €ì¥í•˜ë©´ì„œ ê²°ê³¼ë¥¼ ì¶œë ¥
print(x) # ê¸°ì¡´ì˜ ê°’ ì¶œë ¥
```
        tensor([[2., 4.],
                [6., 8.]])
        tensor([[2., 4.],
                [6., 8.]])


ì´ë ‡ë“¯ xì˜ ê°’ì´ ë®ì–´ ì”Œì›Œì ¸ì„œ 2 ê³±í•˜ê¸° ì—°ì‚°ì´ ëœ ê²°ê³¼ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.  
in-place ì—°ì‚°(ì—°ì‚° ë’¤ì— _ë¶™ì´ê¸°)ì„ ì‚¬ìš©í•˜ë©´ ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ê¸°ì¡´ ë³€ìˆ˜ì˜ ê°’ì´ ë°”ë€ë‹ˆë‹¤.  

ì´ë ‡ë“¯ ê°’ì„ ìì£¼ ì—…ë°ì´íŠ¸ í•´ ì¤˜ì•¼ í•  ë•Œ in-place ì—°ì‚°ì„ ì‚¬ìš©í•œë‹¤ë©´ í¸ë¦¬í•©ë‹ˆë‹¤.  
ì˜ˆë¡œ ë“¤ì–´, ì„ í˜• íšŒê·€ êµ¬í˜„ ì‹œ wì™€ bì˜ ê°’ë“¤ì„ ì—…ë°ì´íŠ¸í•  ë•Œ,   
in-place ì—°ì‚°ì„ ì¨ì£¼ê²Œ ëœë‹¤ë©´, ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ì†ë„ë„ ë¹ ë¥´ê³  ì½”ë“œë„ ê°„í¸í•´ì§„ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.  

í•œê°€ì§€ ì˜ˆì‹œë¥¼ ë” ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.  

```python
import torch

a = torch.ones(5)
print(a)

b = a.numpy()
print(b)

a.add_(1)
print(a)
print(b)
```
        tensor([1., 1., 1., 1., 1.])
        [1. 1. 1. 1. 1.]
        tensor([2., 2., 2., 2., 2.])
        [2. 2. 2. 2. 2.]


### ì„ í˜•ëŒ€ìˆ˜í•™
ì„ í˜•ëŒ€ìˆ˜í•™ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°ë“¤ì„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤

- dot : dot product
- mv, @ : Matrix - Vector product
- mm, @ : Matrix - Matrix product


```python
x = torch.arange(3, dtype=torch.float32)
y = torch.ones(3, dtype = torch.float32)
x, y, torch.dot(x, y)
```




    (tensor([0., 1., 2.]), tensor([1., 1., 1.]), tensor(3.))




```python
A = torch.arange(6, dtype=torch.float32).reshape(2, 3)

A.shape, x.shape, torch.mv(A, x), A@x
```




    (torch.Size([2, 3]), torch.Size([3]), tensor([ 5., 14.]), tensor([ 5., 14.]))




```python
B = torch.ones(3, 4)

print(torch.mm(A, B)) 
print(A@B)
```

    tensor([[ 3.,  3.,  3.,  3.],
            [12., 12., 12., 12.]])
    tensor([[ 3.,  3.,  3.,  3.],
            [12., 12., 12., 12.]])
    

#### Norm  

ë²¡í„°ì˜ í¬ê¸° ë˜ëŠ” ê¸¸ì´ë¥¼ ì¸¡ì •í•˜ëŠ” Normì„ ê³µë¶€í•˜ì˜€ìŠµë‹ˆë‹¤.  
L1 Normê³¼ L2 Normì˜ ì‹ë„ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.


```python
u = torch.tensor([3.0, -4.0])
torch.norm(u) # L2 Norm
```




    tensor(5.)




```python
torch.abs(u).sum() # L1 Norm
```




    tensor(7.)




```python
torch.ones((4, 9))
```




    tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.],
            [1., 1., 1., 1., 1., 1., 1., 1., 1.]])




```python
torch.norm(torch.ones((4, 9)))
```




    tensor(6.)




```python
torch.norm(torch.arange(4,dtype=torch.float32).reshape(2,2))
```




    tensor(3.7417)



#### Autograd  

autogradëŠ” íŒŒì´í† ì¹˜ì˜ ìë™ ë¯¸ë¶„ ì—”ì§„ì…ë‹ˆë‹¤.   
ë¯¸ë¶„ê°’(gradient)ì„ ìˆ˜ì§‘í•˜ê³  ì €ì¥í•´ì¤ë‹ˆë‹¤.  
- requires_grad : ì—°ì‚° ì¶”ì  ì—¬ë¶€ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.  
- backward : ì—­ì „íŒŒ ì‹œì‘  
- grad.zero : ê¸°ìš¸ê¸° ì´ˆê¸°í™”  
- x.grad : ì €ì¥ëœ ê¸°ìš¸ê¸° ë°˜í™˜  


```python
x = torch.arange(4.0)
x
```




    tensor([0., 1., 2., 3.])




```python
x.requires_grad_(True)
x.grad 
```


```python
y = 2 * torch.dot(x, x)
y
```




    tensor(28., grad_fn=<MulBackward0>)




```python
y.backward()
x.grad
```




    tensor([ 0.,  4.,  8., 12.])




```python
x.grad == 4 * x
```




    tensor([True, True, True, True])




```python
x.grad.zero_()  # Reset the gradient
y = x.sum()
y.backward()
x.grad
```




    tensor([1., 1., 1., 1.])




```python
x.grad.zero_()
y = x * x
y.backward(gradient=torch.ones(len(y)))  # Faster: y.sum().backward()
x.grad
```




    tensor([0., 2., 4., 6.])




```python
x.grad.zero_()
y = x * x
u = y.detach()
z = u * x

z.sum().backward()
x.grad == u
```




    tensor([True, True, True, True])



### ì—°ìˆ˜ ) detach(), clone() ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.

#### Tensorë¥¼ ë³µì‚¬í•˜ëŠ” ë°©ë²•

##### 1. detach() : ê¸°ì¡´ Tensorì—ì„œ gradient ì „íŒŒê°€ ì•ˆë˜ëŠ” í…ì„œ ìƒì„±
##### 2. clone() :  ê¸°ì¡´ Tensorì™€ ë‚´ìš©ì„ ë³µì‚¬í•œ í…ì„œ ìƒì„±


```python
import torch
a = torch.randn(5)
a
```




    tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398])




```python
b = a.detach()
c = a.clone()
print(b,c)
```

    tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398]) tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398])
    


```python
b[0] = 1
```


```python
a
```




    tensor([ 1.0000, -0.1637, -0.0640, -0.4010, -0.9398])



 bë¥¼ ë³€ê²½í•˜ì aë„ ë³€í•œê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.


```python
c[0] = 2
```


```python
print(c, a)
```

    tensor([ 2.0000, -0.1637, -0.0640, -0.4010, -0.9398]) tensor([ 1.0000, -0.1637, -0.0640, -0.4010, -0.9398])
    

clone()í•œ tensorëŠ” ê°’ì´ ë³€ê²½ë˜ì–´ë„ ì›ë˜ tensor ê°’ì´ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤


```python

```

<br>
<br>
<br>

---


## 4. DataFrameì„ Tensorë¡œ ë§Œë“¤ê¸°

torch.tensorì„ í†µí•´ ë°ì´í„°í”„ë ˆì„ í˜•íƒœë„ Tensorë¡œ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.  


```python
import os

os.makedirs(os.path.join('..', 'data'), exist_ok=True)
data_file = os.path.join('..', 'data', 'house_tiny.csv')
with open(data_file, 'w') as f:
    f.write('''NumRooms,RoofType,Price
NA,NA,127500
2,NA,106000
4,Slate,178100
NA,NA,140000''')
```


```python
import pandas as pd

data = pd.read_csv(data_file)
print(data)
```

       NumRooms RoofType   Price
    0       NaN      NaN  127500
    1       2.0      NaN  106000
    2       4.0    Slate  178100
    3       NaN      NaN  140000
    


```python
inputs, targets = data.iloc[:, 0:2], data.iloc[:, 2]
inputs = pd.get_dummies(inputs, dummy_na=True)
print(inputs)
```

       NumRooms  RoofType_Slate  RoofType_nan
    0       NaN               0             1
    1       2.0               0             1
    2       4.0               1             0
    3       NaN               0             1
    


```python
inputs = inputs.fillna(inputs.mean())
print(inputs)
```

       NumRooms  RoofType_Slate  RoofType_nan
    0       3.0               0             1
    1       2.0               0             1
    2       4.0               1             0
    3       3.0               0             1
    


```python
X, y = torch.tensor(inputs.values), torch.tensor(targets.values)
X, y
```




    (tensor([[3., 0., 1.],
             [2., 0., 1.],
             [4., 1., 0.],
             [3., 0., 1.]], dtype=torch.float64),
     tensor([127500, 106000, 178100, 140000]))

### ì¬ì˜ ) Array - Tensor ê°„ ë³€í™˜ ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”.

Pytorchì—ì„œ numpy arrayë¥¼ Tensor ìë£Œí˜•ìœ¼ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ì„œëŠ” `torch.Tensor()`ì™€ `torch.from_numpy()`ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ë¨¼ì €, `torch.Tensor()` ë¥¼ [pytorch ê³µì‹ ë¬¸ì„œ](https://pytorch.org/docs/stable/tensors.html)ì—ì„œ í™•ì¸í•´ë³¸ë‹¤ë©´ ë§ê·¸ëŒ€ë¡œ Tensorë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” êµ¬ë¬¸ì´ê¸° ë•Œë¬¸ì— ë‚˜ì™€ ìˆëŠ” ì˜ˆì‹œì—ëŠ” arrayê°€ ì§ì ‘ ë“¤ì–´ê°€ ìˆëŠ” ê²½ìš°ë¥¼ ë§ì´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ ìƒì„±ë˜ëŠ” Tensorì˜ ë°ì´í„° íƒ€ì…ë§ˆë‹¤ ì–´ë– í•œ êµ¬ë¬¸ì„ ì¨ì•¼í•˜ëŠ”ì§€ ë‚˜íƒ€ë‚˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì´ë¯¸ì§€ëŠ” ê·¸ ì¤‘ ì¼ë¶€ë¥¼ ë°œì·Œí•œ ê²ƒì…ë‹ˆë‹¤.

<div align = "center"> <img src = "https://drive.google.com/uc?id=14E34d4n2UhkkVNlCL0EanexuC8gS_hyL" /> </div>



ë˜í•œ, `torch.from_numpy()` ë¥¼ [pytorch ê³µì‹ ë¬¸ì„œ]("https://pytorch.org/docs/stable/generated/torch.from_numpy.html")ì—ì„œ í™•ì¸í•´ë³¸ë‹¤ë©´ `Creates a Tensor from a numpy.ndarray` ë¼ê³  ì„¤ëª…ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ ê·¸ëŒ€ë¡œ numpyë¡œ ë§Œë“¤ì–´ì§„ arrayë¥¼ tensorë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.

<div align = "center"> <img src="https://drive.google.com/uc?id=1DGSJhwGKGAkVUm478YmIRP25nhycTbHj" /> </div>

ë‹¤ë§Œ, ì£¼ì˜í•´ì•¼í•  ì ì€ ë§Œë“¤ì–´ì§„ tensorëŠ” ê¸°ì¡´ì˜ ndarrayì™€ ë™ì¼í•œ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ê·¸ë ‡ê¸°ì— tensorì— ëŒ€í•œ ìˆ˜ì • ì‚¬í•­ì´ ndarrayì— ë°˜ì˜ë˜ê³ , ê·¸ ë°˜ëŒ€ì˜ ê²½ìš° ë˜í•œ ì ìš©ëœë‹¤ëŠ” ì ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. 

ë˜í•œ, ê·¸ë¡œ ì¸í•´ ë§Œë“¤ì–´ì§„ tensorì˜ í¬ê¸°ëŠ” ê·¸ ì´í›„ ì¡°ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ì™€ ê´€ë ¨ëœ ê³µì‹ ë¬¸ì„œì˜ ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤. 

<div align = "center"> <img src="https://drive.google.com/uc?id=1VfaE2osqXmezYhioaXN2kLW8VzBCjk4u" /> </div>

ê·¸ë ‡ë‹¤ë©´ ì •ë§ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.

ë¨¼ì €, `torch.Tensor()` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ numpy arrayë¥¼ Tensorë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.

```python
import numpy as np
import torch

arr = np.array([1,2,3,4,5])
print(type(arr))

arr_tensor = torch.Tensor(arr)
print(type(arr_tensor))
```

ì•„ë˜ì™€ ê°™ì´ í•´ë‹¹í•˜ëŠ” typeì´ ë³€ê²½ë˜ëŠ” ê²ƒì„ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<div align=center> <img src="https://drive.google.com/uc?id=1Wk4zEELWdLsoaOuf-ruHm1Q-V7-I0HEo" /> </div>



ë‹¤ìŒìœ¼ë¡œëŠ” `torch.from_numpy()` í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ numpy arrayë¥¼ Tensorë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.

```python
import numpy as np
import torch

arr2 = np.array([2,3,4])
print(type(arr2))

arr_tensor2 = torch.from_numpy(arr2)
print(type(arr_tensor2))
```

ì•„ë˜ì™€ ê°™ì´ í•´ë‹¹í•˜ëŠ” typeì´ ë³€í™˜ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<div align=center><img src="https://drive.google.com/uc?id=1Wk4zEELWdLsoaOuf-ruHm1Q-V7-I0HEo" /></div>



ì´ì™€ ë°˜ëŒ€ë¡œ Pytorchì—ì„œ tensorì—ì„œ numpyë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œëŠ” `torch.Tensor.numpy()` êµ¬ë¬¸ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ [pytorch ê³µì‹ë¬¸ì„œ](https://pytorch.org/docs/stable/generated/torch.Tensor.numpy.html)ì—ì„œ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ê°„ê²°í•˜ê²Œ ì—­í• ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

ì•ì„  `torch.from_numpy()` ì™€ ë§ˆì°¬ê°€ì§€ë¡œ `torch.Tensor.numpy()` ë˜í•œ ê° tensorì™€ ndarrayëŠ” ê°™ì€ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•˜ê²Œ ë©ë‹ˆë‹¤. 

<div align = "center"> <img src="https://drive.google.com/uc?id=1OGc3E3BBM3DjMMeanVGkkiEGV0v0BgKB" /> </div>

ì´ì œëŠ” `numpy()` ë¥¼ í™œìš©í•˜ì—¬ ë³€í™˜ëœ Tensorë¥¼ numpy arrayë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.

```python
import numpy as np
import torch

arr_numpy = arr_tensor.numpy()
print(type(arr_numpy))
```

ì•„ë˜ì™€ ê°™ì´ `numpy.ndarray` íƒ€ì…ìœ¼ë¡œ ë³€í™˜ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

<div align=center><img src="https://drive.google.com/uc?id=1p-YqWDZnsikTgAA67YuSpayk6Ko2Qtvo" /></div>

<br>
<br>
<br>

---


## 5. ì‹¤ìŠµ

ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©ì„ ì§ì ‘ íƒ€ì´í•‘í•´ë³´ëŠ” ì‹œê°„ë„ ê°€ì¡ŒìŠµë‹ˆë‹¤!  
ì‹œê°„ì´ ì—¬ìœ ë¡­ì§€ì•Šì•„ ì™„ë²½í•˜ê²ŒëŠ” ëª»í–ˆì§€ë§Œ ë‹¤ìŒë²ˆì—ëŠ” ë” ë‚˜ì€ ì‹¤ìŠµë“¤ë¡œ ë§ˆë ¨í•´ë³¼ê²Œìš” ğŸ’¯

#### 1. (2,3) í˜•íƒœì˜ 0~1 ì‚¬ì´ì˜ ë¬´ì‘ìœ„ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”.


```python
x = torch.randn(2, 3)
x
```




    tensor([[-1.1449e+00, -5.8245e-01, -4.2747e-01],
            [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])



#### 2. ìœ„ í…ì„œì˜ íƒ€ì…ì„ ì¶œë ¥í•´ë³´ì„¸ìš”.(dtype)


```python
x.dtype
```




    torch.float32



#### 3. 1ë¶€í„° 3ê¹Œì§€ ìˆœì„œëŒ€ë¡œ ì´ë£¨ì–´ì§„ int typeì˜ í…ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”.


```python
y = torch.arange(1,4, dtype=torch.int64)
y
```




    tensor([1, 2, 3])



#### 4. ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œì™€ ë‘ë²ˆì§¸ ìƒì„±í•œ í…ì„œì˜ ê³±ì„ í•˜ê³  ì—°ì‚°ì´ ë˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?


```python
x*y
```




    tensor([[-1.1449e+00, -1.1649e+00, -1.2824e+00],
            [ 2.1382e-05, -5.0074e-01,  3.9180e-01]])



#### 5. ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œë¥¼ Transposeí•˜ê³  ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œì™€ í–‰ë ¬ê³±ì„ ì§„í–‰í•´ë³´ì„¸ìš”


```python
z = x.T
z
```




    tensor([[-1.1449e+00,  2.1382e-05],
            [-5.8245e-01, -2.5037e-01],
            [-4.2747e-01,  1.3060e-01]])




```python
z@x
```




    tensor([[1.3107, 0.6668, 0.4894],
            [0.6668, 0.4019, 0.2163],
            [0.4894, 0.2163, 0.1998]])



#### 6. í–‰ë ¬ê³±ì„ ì§„í–‰í•œ í…ì„œì™€ ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œë¥¼ Concatenateí•˜ì„¸ìš”


```python
x
```




    tensor([[-1.1449e+00, -5.8245e-01, -4.2747e-01],
            [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])




```python
print(torch.cat([z@x, x], dim=0))
```

    tensor([[ 1.3107e+00,  6.6682e-01,  4.8940e-01],
            [ 6.6682e-01,  4.0193e-01,  2.1628e-01],
            [ 4.8940e-01,  2.1628e-01,  1.9979e-01],
            [-1.1449e+00, -5.8245e-01, -4.2747e-01],
            [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])
    

#### 7. ë‘ë²ˆì§¸ì— ë§Œë“  í…ì„œë¥¼ unsqueezeí•˜ê³  shapeë¥¼ ì¶œë ¥í•˜ì„¸ìš” (dim=1)


```python
print(y.unsqueeze(1))
print(y.unsqueeze(1).shape)
```

    tensor([[1],
            [2],
            [3]])
    torch.Size([3, 1])
    

#### 8. unsqueezeí•œ í…ì„œë¥¼ squeezeí•˜ì„¸ìš” shapeë¥¼ ì¶œë ¥í•˜ì„¸ìš” (dim=1)


```python
k = y.unsqueeze(1)
print(k.squeeze(1))
print(k.squeeze(1).shape)
```

    tensor([1, 2, 3])
    torch.Size([3])
    

#### 9. 0ë¶€í„° 5ì˜ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ (2,3)í˜•íƒœì˜ í…ì„œê³  Normì„ êµ¬í•´ì£¼ì„¸ìš”




```python
A = torch.arange(6, dtype=torch.float32).reshape(2, 3)
A
```




    tensor([[0., 1., 2.],
            [3., 4., 5.]])




```python
torch.norm(A)
```




    tensor(7.4162)



#### 10. í•´ë‹¹ ì½”ë“œê°€ ëŒì•„ê°€ë„ë¡ ì•Œë§ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!


```python
import torch

x = torch.ones(5)  # input tensor
y = torch.zeros(3)  # expected output
w = torch.randn(5, 3,requires_grad=True)
b = torch.randn(3,requires_grad=True)
z = torch.matmul(x, w)+b
loss = torch.nn.functional.binary_cross_entropy_with_logits(z, y)
```


```python
print(f"Gradient function for z = {z.grad_fn}")
print(f"Gradient function for loss = {loss.grad_fn}")
```

    Gradient function for z = <AddBackward0 object at 0x7f5523e0a210>
    Gradient function for loss = <BinaryCrossEntropyWithLogitsBackward0 object at 0x7f5523e0a5d0>
    


```python
loss.backward()
print(w.grad)
print(b.grad)
```

    tensor([[0.0139, 0.3273, 0.0794],
            [0.0139, 0.3273, 0.0794],
            [0.0139, 0.3273, 0.0794],
            [0.0139, 0.3273, 0.0794],
            [0.0139, 0.3273, 0.0794]])
    tensor([0.0139, 0.3273, 0.0794])
    

#### 11. ì•„ë˜ Falseê°€ ë‚˜ì˜¨ ê²°ê³¼ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ë„ë¡ ì½”ë“œë¥¼ ì™„ì„±í•´ì£¼ì„¸ìš”.


```python
z = torch.matmul(x, w)+b
print(z.requires_grad)

with torch.no_grad():
    z = torch.matmul(x, w)+b
print(z.requires_grad)
```

    True
    False
    


```python
z = torch.matmul(x, w)+b
z_det = z.detach()
print(z_det.requires_grad)
```

    False
    

#### 12. ì½”ë© Sample dataì˜ california_housing_trainì—ì„œ median_house_valueë¥¼ targetìœ¼ë¡œ í•˜ê³  Tensorí˜•íƒœë¡œ ë³€í™˜í•´ë³´ì„¸ìš”


```python
import pandas as pd

data = pd.read_csv('/content/sample_data/california_housing_train.csv')
print(data)
```

           longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
    0        -114.31     34.19                15.0       5612.0          1283.0   
    1        -114.47     34.40                19.0       7650.0          1901.0   
    2        -114.56     33.69                17.0        720.0           174.0   
    3        -114.57     33.64                14.0       1501.0           337.0   
    4        -114.57     33.57                20.0       1454.0           326.0   
    ...          ...       ...                 ...          ...             ...   
    16995    -124.26     40.58                52.0       2217.0           394.0   
    16996    -124.27     40.69                36.0       2349.0           528.0   
    16997    -124.30     41.84                17.0       2677.0           531.0   
    16998    -124.30     41.80                19.0       2672.0           552.0   
    16999    -124.35     40.54                52.0       1820.0           300.0   
    
           population  households  median_income  median_house_value  
    0          1015.0       472.0         1.4936             66900.0  
    1          1129.0       463.0         1.8200             80100.0  
    2           333.0       117.0         1.6509             85700.0  
    3           515.0       226.0         3.1917             73400.0  
    4           624.0       262.0         1.9250             65500.0  
    ...           ...         ...            ...                 ...  
    16995       907.0       369.0         2.3571            111400.0  
    16996      1194.0       465.0         2.5179             79000.0  
    16997      1244.0       456.0         3.0313            103600.0  
    16998      1298.0       478.0         1.9797             85800.0  
    16999       806.0       270.0         3.0147             94600.0  
    
    [17000 rows x 9 columns]
    


```python
data.columns
```




    Index(['longitude', 'latitude', 'housing_median_age', 'total_rooms',
           'total_bedrooms', 'population', 'households', 'median_income',
           'median_house_value'],
          dtype='object')




```python
inputs, targets = data.iloc[:, 0:-1], data.iloc[:, -1]
inputs = pd.get_dummies(inputs, dummy_na=True)
print(inputs.head())
```

       longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
    0    -114.31     34.19                15.0       5612.0          1283.0   
    1    -114.47     34.40                19.0       7650.0          1901.0   
    2    -114.56     33.69                17.0        720.0           174.0   
    3    -114.57     33.64                14.0       1501.0           337.0   
    4    -114.57     33.57                20.0       1454.0           326.0   
    
       population  households  median_income  
    0      1015.0       472.0         1.4936  
    1      1129.0       463.0         1.8200  
    2       333.0       117.0         1.6509  
    3       515.0       226.0         3.1917  
    4       624.0       262.0         1.9250  
    


```python
inputs = inputs.fillna(inputs.mean())
print(inputs.head())
```

       longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
    0    -114.31     34.19                15.0       5612.0          1283.0   
    1    -114.47     34.40                19.0       7650.0          1901.0   
    2    -114.56     33.69                17.0        720.0           174.0   
    3    -114.57     33.64                14.0       1501.0           337.0   
    4    -114.57     33.57                20.0       1454.0           326.0   
    
       population  households  median_income  
    0      1015.0       472.0         1.4936  
    1      1129.0       463.0         1.8200  
    2       333.0       117.0         1.6509  
    3       515.0       226.0         3.1917  
    4       624.0       262.0         1.9250  
    


```python
X, y = torch.tensor(inputs.values), torch.tensor(targets.values)
X, y
```




    (tensor([[-114.3100,   34.1900,   15.0000,  ..., 1015.0000,  472.0000,
                 1.4936],
             [-114.4700,   34.4000,   19.0000,  ..., 1129.0000,  463.0000,
                 1.8200],
             [-114.5600,   33.6900,   17.0000,  ...,  333.0000,  117.0000,
                 1.6509],
             ...,
             [-124.3000,   41.8400,   17.0000,  ..., 1244.0000,  456.0000,
                 3.0313],
             [-124.3000,   41.8000,   19.0000,  ..., 1298.0000,  478.0000,
                 1.9797],
             [-124.3500,   40.5400,   52.0000,  ...,  806.0000,  270.0000,
                 3.0147]], dtype=torch.float64),
     tensor([ 66900.,  80100.,  85700.,  ..., 103600.,  85800.,  94600.],
            dtype=torch.float64))

<br>
<br>
<br>

---

## 6. ë§ˆì¹˜ë©°

ë„ˆë¬´ ë§ì€ ë‚´ìš©ì„ í–ˆì—ˆë˜ 2ì£¼ì°¨ì˜€ìŠµë‹ˆë‹¤!!  
Tensorë¥¼ ì–´ë–¤ ì‹ìœ¼ë¡œ ë§Œì§€ê³  ë³€ê²½í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œê²Œë˜ëŠ” 2ì£¼ì°¨ì˜€ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤!  