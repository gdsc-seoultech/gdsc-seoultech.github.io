<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="tYMwPoxNrWfLx2sDrDYzqI4-dq3M3FfI56NBL9JNtH8" />

    <title>ë”¥ëŸ¬ë‹ 2ì£¼ì°¨ - ë°ì´í„°ì˜ ê¸°ë³¸ê³¼ í…ì„œ</title>
    <meta name="description" content="A simple, whitespace, helvetica based portfolio theme.
">

    <link rel = "shortcut icon" type="image/x-icon" href="/img/square_logo.png">
    <link rel="stylesheet" href="/css/main.css">
<!--    <link rel="canonical" href="http://localhost:4000/posts/2nd_term/dl/2022-09-28-dl-2st-week/">-->
    <link rel="canonical" href="/posts/2nd_term/dl/2022-09-28-dl-2st-week/">

    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

    <!-- ì¹´í…Œê³ ë¦¬ css -->
    <link rel="stylesheet" href="/css/pagination.css">
    <link href="/css/category.css" type="text/css" rel="stylesheet">
</head>

   
  <body>
    <script src="/js/default.js"></script>
    <header id="tab" >
  <script src="https://code.jquery.com/jquery-1.11.0.min.js"></script>
  <div class="site-header">
    <div class="wrapper">
      <div>
        <a href="/">
          <img src="/img/square_logo.png" align="left" width="57px">
        </a>
      </div>

      <nav class="site-nav">

        <div id="tab" class="trigger">
          <!-- GDSC Seoultech instead of blog -->
          <a class="page-link" href="/">GDSC</a>
          <a class="page-link" href="/members/2">MEMBER</a>
          <a class="page-link" href="/category/2nd_term">POST</a>
        </div>
      </nav>
    </div>
  </div>

  <div id="hovering" class="tab-header">
    <div class="wrapper">
      <div class="detail-post">
          <div class="tab-item">
            <div><a class="page-link-detail" href="/category/1st_term">1ê¸°</a></div>
            <div><a class="page-link-detail" href="/category/2nd_term">2ê¸°</a></div>
          </div>
      </div>
      <div class="detail-member">
        <div class="tab-item">
          <div><a class="page-link-detail" href="/members/1">1ê¸°</a></div>
          <div><a class="page-link-detail" href="/members/2">2ê¸°</a></div>
        </div>
    </div>
    </div>

  </div>

  <script type="text/javascript">
    var tabMenu = $("#tab");
    var tabSubMenu = $("#hovering");

    tabSubMenu.hide()

    tabMenu.hover(function() {
      tabSubMenu.show();
    }, function() {
      tabSubMenu.hide();
    })
  </script>

</header>


    <div class="page-content" id="page-content">
      <div class="wrapper" id="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">ë”¥ëŸ¬ë‹ 2ì£¼ì°¨ - ë°ì´í„°ì˜ ê¸°ë³¸ê³¼ í…ì„œ</h1>
    <h1 class="post-description"></h1>
    <p class="post-meta">September 28, 2022 â€” 09:00 â€¢ keonju</p>
    
      
        <span class="tag">dl</span>
      
    
  </header>
  <article class="post-content">
    <h1 id="2ì£¼ì°¨ëŠ”-ë¬´ì—‡ì„-ë°°ì› ë‚˜ìš”">2ì£¼ì°¨ëŠ” ë¬´ì—‡ì„ ë°°ì› ë‚˜ìš”</h1>

<ol>
  <li>Tensor ë§Œë“¤ê¸°</li>
  <li>Tensor ë°”ê¾¸ê¸°</li>
  <li>Tensor ì—°ì‚°í•˜ê¸°</li>
  <li>DataFrameì„ Tensorë¡œ ë§Œë“¤ê¸°</li>
  <li>ì‹¤ìŠµ</li>
  <li>ë§ˆì¹˜ë©°</li>
</ol>

<p>ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤! <br />
ì§€ë‚œì£¼ì— ë°°ì› ë˜ Numpyì™€ ë¹„ìŠ·í•œ Tensorì´ì§€ë§Œ ë” ë§ì€ ë‚´ìš©ì„ ë‹¤ë¤˜ìŠµë‹ˆë‹¤!<br />
ë‚´ìš©ì´ ë§ì´ ëŠ˜ì–´ë‚˜ ë§ì´ í˜ë“¤ì—ˆì§€ë§Œ ë‹¤ë“¤ ì—´ì‹­íˆ ì°¸ì—¬í•´ì£¼ì…¨ìŠµë‹ˆë‹¤..! (ë¶„ëŸ‰ ì¡°ì ˆ ì‹¤íŒ¨í•œ ì‚¬ëŒ ë°˜ì„±ì¤‘.. ğŸ¥º)<br />
ì´ë²ˆì—ë„ ì¤‘ê°„ì¤‘ê°„ ê³¼ì œë¡œ ë” ê³µë¶€í•œ ë‚´ìš©ë“¤ë„ ìˆìœ¼ë‹ˆ ì°¸ê³ í•´ì£¼ì„¸ìš”!</p>

<p>í•¨ê»˜ ê¸°ë³¸ ë°ì´í„° êµ¬ì¡°ì¸ í…ì„œë¥¼ ì‹œì‘ìœ¼ë¡œ ë³¸ê²©ì ìœ¼ë¡œ ë”¥ëŸ¬ë‹ ê¸°ì´ˆë¥¼ ë‹¤ì ¸ë³´ì•„ìš”!!</p>

<p><br /> 
<br /> 
<br /></p>

<hr />

<h2 id="1-tensor-ë§Œë“¤ê¸°">1. Tensor ë§Œë“¤ê¸°</h2>
<p>Tensorë¥¼ ë§Œë“¤ê³  Tensorì˜ ìš”ì†Œë“¤ì„ í™•ì¸í•˜ëŠ” ë°©ë²•ì„ ë¨¼ì € ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<p><br /> 
<br /></p>

<h3 id="tensor-ìƒì„±">Tensor ìƒì„±</h3>
<ul>
  <li>arange : ê°™ì€ ê°„ê²©ì˜ 1ì°¨ì› í…ì„œ</li>
  <li>zeros : 0ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ</li>
  <li>ones : 1ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ</li>
  <li>randn : 0~1ì˜ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œ</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([ 0.,  1.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[[0., 0., 0., 0.],
         [0., 0., 0., 0.],
         [0., 0., 0., 0.]],

        [[0., 0., 0., 0.],
         [0., 0., 0., 0.],
         [0., 0., 0., 0.]]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[[1., 1., 1., 1.],
         [1., 1., 1., 1.],
         [1., 1., 1., 1.]],

        [[1., 1., 1., 1.],
         [1., 1., 1., 1.],
         [1., 1., 1., 1.]]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[-1.4006,  0.6990, -0.3430, -0.4306],
        [ 1.2131, -0.1662, -0.8585,  0.0919],
        [ 1.5555, -1.7267, -1.5563,  0.0836]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[2, 1, 4, 3],
        [1, 2, 3, 4],
        [4, 3, 2, 1]])
</code></pre></div></div>

<h3 id="tensor-í˜•íƒœ-íŒŒì•…í•˜ê¸°">Tensor í˜•íƒœ íŒŒì•…í•˜ê¸°</h3>

<ul>
  <li>numel : element ìˆ˜ íŒŒì•…</li>
  <li>shape : Tensor í˜•íƒœ íŒŒì•…</li>
  <li>dtype : ë°ì´í„° íƒ€ì… íŒŒì•…</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">numel</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>12
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.Size([12])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">dtype</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.float32
</code></pre></div></div>

<h3 id="ì¤€ì„--tensorì˜-íƒ€ì…ì„-ì•Œë ¤ì£¼ì„¸ìš”">ì¤€ì„ ) Tensorì˜ íƒ€ì…ì„ ì•Œë ¤ì£¼ì„¸ìš”.</h3>

<p>torch.Tensor()ì˜ ê¸°ë³¸ í…ì„œ íƒ€ì…ì€ torch.FloatTensor ì´ë‹¤.</p>

<p>í…ì„œ íƒ€ì…ì€ ì´ˆê¸°í™” í•  ë•Œ ì§€ì •í•˜ê±°ë‚˜ ë‚˜ì¤‘ì— ë‹¤ë¥¸ íƒ€ì…ìœ¼ë¡œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.</p>
<ul>
  <li>ì´ˆê¸°í™” ì‹œ íƒ€ì… ì§€ì •<br />
1) FloatTensor ê°™ì€ íŠ¹ì • í…ì„œ íƒ€ì…ì˜ ìƒì„±ìë¥¼ ì§ì ‘ í˜¸ì¶œ ë˜ëŠ” íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ ì‚¬ìš©<br />
2) torch.Tensor()ì™€ í•¨ê»˜ dtype ë§¤ê°œë³€ìˆ˜ë¥¼ ì‚¬ìš©</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="k">def</span> <span class="nf">describe</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"íƒ€ì…: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="nb">type</span><span class="p">()))</span>
    <span class="k">print</span><span class="p">(</span><span class="s">"ê°’: {}"</span><span class="p">.</span><span class="nb">format</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># floatí˜•
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.FloatTensor
ê°’: tensor([[1., 2., 3.],
        [4., 5., 6.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">LongTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># longí˜•
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.LongTensor
ê°’: tensor([[1, 2, 3],
        [4, 5, 6]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ShortTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]])</span>
<span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># shortí˜•
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.ShortTensor
ê°’: tensor([[1, 2, 3],
        [4, 5, 6]], dtype=torch.int16)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">double</span><span class="p">()</span>
<span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.DoubleTensor
ê°’: tensor([[1., 2., 3.],
        [4., 5., 6.]], dtype=torch.float64)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nb">int</span><span class="p">()</span>
<span class="n">describe</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.IntTensor
ê°’: tensor([[1, 2, 3],
        [4, 5, 6]], dtype=torch.int32)
</code></pre></div></div>

<h4 id="ì—¬ê¸°ê¹Œì§€ëŠ”-ì•ì„œ-ì–¸ê¸‰í–ˆë˜-ì²«-ë²ˆì§¸-ë°©ì‹ìœ¼ë¡œ-tensorì˜-íƒ€ì…ì„-ì§€ì •í–ˆë‹¤">ì—¬ê¸°ê¹Œì§€ëŠ” ì•ì„œ ì–¸ê¸‰í–ˆë˜ ì²« ë²ˆì§¸ ë°©ì‹ìœ¼ë¡œ tensorì˜ íƒ€ì…ì„ ì§€ì •í–ˆë‹¤</h4>
<ul>
  <li>FloatTensor ê°™ì€ íŠ¹ì • í…ì„œ íƒ€ì…ì˜ ìƒì„±ìë¥¼ ì§ì ‘ í˜¸ì¶œ ë˜ëŠ” íƒ€ì… ìºìŠ¤íŒ… ë©”ì†Œë“œ ì‚¬ìš©</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">float64</span><span class="p">)</span>
<span class="n">describe</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.DoubleTensor
ê°’: tensor([[1., 2., 3.],
        [4., 5., 6.],
        [7., 8., 9.]], dtype=torch.float64)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],[</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">describe</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>íƒ€ì…: torch.LongTensor
ê°’: tensor([[1, 2, 3],
        [4, 5, 6],
        [7, 8, 9]])
</code></pre></div></div>

<h4 id="ì—¬ê¸°ê¹Œì§€ëŠ”-ë‘-ë²ˆì¨°-ë°©ì‹ì„-ì´ìš©í–ˆë‹¤">ì—¬ê¸°ê¹Œì§€ëŠ” ë‘ ë²ˆì¨° ë°©ì‹ì„ ì´ìš©í–ˆë‹¤.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># shape ë˜ëŠ” size()ë¥¼ í†µí•´ í…ì„œì˜ í¬ê¸°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
</span><span class="n">y</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.Size([3, 3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span><span class="p">.</span><span class="n">size</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.Size([3, 3])
</code></pre></div></div>

<p><img src="https://user-images.githubusercontent.com/54880474/192807948-44620bd9-6991-476e-adfe-55a6dd7464af.png" alt="20220928_233616" /></p>

<h5 id="ë‹¤ìŒê³¼-ê°™ì´-ê°-ë°ì´í„°í˜•-ë³„ë¡œ-ë°ì´í„°-íƒ€ì…ì´-ì •í•´ì ¸ìˆëŠ”-ê²ƒì„-ì•Œ-ìˆ˜-ìˆë‹¤">ë‹¤ìŒê³¼ ê°™ì´ ê° ë°ì´í„°í˜• ë³„ë¡œ ë°ì´í„° íƒ€ì…ì´ ì •í•´ì ¸ìˆëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</h5>

<h3 id="ì¸ë±ì‹±ê³¼-ìŠ¬ë¼ì´ì‹±">ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±</h3>

<p>ë„˜íŒŒì´ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì¸ë±ì‹±ê³¼ ìŠ¬ë¼ì´ì‹±, ê°’ë„ ë³€í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(11.)
tensor([1., 2.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">17</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([ 0., 17.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([12., 12.,  2.,  3.,  4.,  5.,  6.,  7.,  8.,  9., 10., 11.])
</code></pre></div></div>

<p><br />
<br />
<br />
â€”</p>

<h2 id="2-tensor-ë°”ê¾¸ê¸°">2. Tensor ë°”ê¾¸ê¸°</h2>
<p>Tensor í˜•íƒœë¥¼ ë³€í™˜í•˜ê³  Tensorì„ í•©ì¹˜ê³ , ë‚˜ëˆ„ëŠ” ë°©ë²•ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.<br />
<br /></p>

<h3 id="tensor-í˜•íƒœ-ë³€í™˜">Tensor í˜•íƒœ ë³€í™˜</h3>
<ul>
  <li>reshape : contiguousí•˜ì§€ ì•Šì„ ë•Œë„ ë³€í™˜ ê°€ëŠ¥!</li>
  <li>view : contiguousí•˜ì§€ ì•Šìœ¼ë©´ ë³€í™˜ ë¶ˆê°€ëŠ¥!</li>
  <li>squeeze : 1ì¸ ì°¨ì› ì œê±°</li>
  <li>unsqueeze : 1ì¸ ì°¨ì› ì¶”ê°€</li>
  <li>transpose : ì „ì¹˜ í–‰ë ¬</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">X</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[12., 12.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>

<span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]],</span>
              <span class="p">[[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span>
               <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">]]])</span>
<span class="n">ft</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.Size([2, 2, 3])
</code></pre></div></div>

<p>-1ì€ ë‹¤ë¥¸ ì°¨ì›ìœ¼ë¡œë¶€í„° ë§ì¶°ì„œ ë³€í™˜ë©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[ 0.,  1.,  2.],
        [ 3.,  4.,  5.],
        [ 6.,  7.,  8.],
        [ 9., 10., 11.]])
torch.Size([4, 3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[[ 0.,  1.,  2.]],

        [[ 3.,  4.,  5.]],

        [[ 6.,  7.,  8.]],

        [[ 9., 10., 11.]]])
torch.Size([4, 1, 3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ft</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">]])</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.],
        [1.],
        [2.]])
torch.Size([3, 1])
</code></pre></div></div>

<p>squeezeë¥¼ í†µí•´ 2ì°¨ì›ì—ì„œ 1ì°¨ì›ìœ¼ë¡œ ë³€í˜•ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">squeeze</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">squeeze</span><span class="p">().</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([0., 1., 2.])
torch.Size([3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ft</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.Size([3])
</code></pre></div></div>

<p>ë‹¤ì‹œ unsqueezeë¥¼ í†µí•´ 2ì°¨ì›ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0., 1., 2.]])
torch.Size([1, 3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0., 1., 2.]])
torch.Size([1, 3])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.],
        [1.],
        [2.]])
torch.Size([3, 1])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">ft</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.],
        [1.],
        [2.]])
torch.Size([3, 1])
</code></pre></div></div>

<p>TransposeëŠ” í–‰ê³¼ ì—´ì„ ë°”ê¿”ì£¼ëŠ” ë°©ë²•ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">A</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0, 1],
        [2, 3],
        [4, 5]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span><span class="p">.</span><span class="n">T</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0, 2, 4],
        [1, 3, 5]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]])</span>
<span class="n">A</span> <span class="o">==</span> <span class="n">A</span><span class="p">.</span><span class="n">T</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[True, True, True],
        [True, True, True],
        [True, True, True]])
</code></pre></div></div>

<h3 id="í˜--contiguousì—-ëŒ€í•´-ì•Œë ¤ì£¼ì„¸ìš”">í˜ ) contiguous()ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.</h3>

<p>contiguous()ëŠ” í…ì„œë¥¼ numpyê°™ì€ ë°©ì‹ìœ¼ë¡œ ë©”ëª¨ë¦¬ì— ì €ì¥í•˜ëŠ” ë°©ì‹ì„ ë§í•©ë‹ˆë‹¤.<br />
numpyëŠ” ì¸ì ‘í•œ ë°°ì—´ì˜ ë°ì´í„°ëŠ” ì¸ì ‘í•œ ë©”ëª¨ë¦¬ì— ì €ì¥í•¨ìœ¼ë¡œì¨ ì ‘ê·¼ì†ë„ë‚˜ transposeì†ë„ê°€ ë§¤ìš° ë¹ ë¥´ê²Œë©ë‹ˆë‹¤.<br />
ë³´í†µ view(),narrow(),expand(),tranpose()ë¥¼ ì¨ì„œ í…ì„œëª¨ì–‘ì„ ê³ ì¹ ë•Œ contiguousí˜•ì‹ì´ ìš”êµ¬ë˜ëŠ”ë°<br />
ì˜ˆë¥¼ ë“¤ì–´ view()ê°™ì€ ê²½ìš°ëŠ” reshapeë‚˜ resizeì™€ëŠ” ë‹¤ë¥´ê²Œ ì–´ë–¤ ê²½ìš°ì—ë„ ë©”ëª¨ë¦¬ ë³µì‚¬ì—†ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.<br />
ë”°ë¼ì„œ contiguousí˜•ì‹ì´ ì•„ë‹ë•ŒëŠ” í…ì„œëª¨ì–‘ì„ ê³ ì¹ ìˆ˜ ì—†ê²Œë˜ê³  ëŸ°íƒ€ì„ì—ëŸ¬ê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>

<p>ì½”ë“œë¥¼ í†µí•´ì„œ contiguousì— ëŒ€í•´ ì„¤ëª…í•˜ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="n">a</span><span class="p">.</span><span class="n">transpose_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True
tensor([[ 1.0009,  0.1026, -1.1214],
        [ 0.7532,  2.0344,  1.4519],
        [-0.5742, -1.3162,  1.5134],
        [ 1.2349, -1.2356,  1.7235]])
True
tensor([[-0.2183,  2.2920, -0.2232],
        [ 0.0463, -0.4723,  0.8091],
        [-0.7852,  1.6145, -0.2895],
        [ 0.5062,  0.6791,  1.3657]])
</code></pre></div></div>

<p>ëœë¤ìœ¼ë¡œ aì™€ bë¼ëŠ” Tensorë¥¼ ë§Œë“¤ì—ˆìŠµë‹ˆë‹¤.<br />
aì™€ bëŠ” í˜•ì„±ë˜ì–´ì¡Œì„ ë•Œ, is_contiguousë¥¼ í†µí•´ì„œ ë‘ Tensor ëª¨ë‘ contiguousí•œ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ê·¸ëŸ¼ ì•„ë˜ì˜ ì½”ë“œë¥¼ í†µí•´ tranpose ì´í›„ aì™€ bì˜ ì°¨ì´ë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="n">data_ptr</span><span class="p">())</span>
  
<span class="k">print</span><span class="p">(</span><span class="s">'*'</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
  <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
    <span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">].</span><span class="n">data_ptr</span><span class="p">())</span>    
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1863763599552
1863763599568
1863763599584
1863763599556
1863763599572
1863763599588
1863763599560
1863763599576
1863763599592
1863763599564
1863763599580
1863763599596
**********
1863763604288
1863763604292
1863763604296
1863763604300
1863763604304
1863763604308
1863763604312
1863763604316
1863763604320
1863763604324
1863763604328
1863763604332
</code></pre></div></div>

<p>ê° í…ì„œ ìš”ì†Œì˜ ì£¼ì†Œë¥¼ ì¶”ì¶œí•˜ì˜€ìŠµë‹ˆë‹¤.<br />
ê° ë°ì´í„° íƒ€ì…ì¸ torch.float32 ìë£Œí˜•ì€ 4ë°”ì´íŠ¸ ì´ë¯€ë¡œ,<br />
ë©”ëª¨ë¦¬ 1ì¹¸ ë‹¹ ì£¼ì†Œ ê°’ì´ 4ì”© ì¦ê°€í•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
bëŠ” í•œ ì¤„ì— 4ì”© ê°’ì´ ì¦ê°€í•˜ì§€ë§Œ aëŠ” ê·¸ë ‡ì§€ ì•Šì€ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì•„ë˜ì½”ë“œë¥¼ ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">stride</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">stride</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(1, 4)
(3, 1)
False
True
</code></pre></div></div>

<p>aê°€ tranposeëœ ì´í›„ì— falseë¡œ ë°”ë€ ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ì¦‰ bëŠ” ì˜¤ë¥¸ìª½ ë°©í–¥ìœ¼ë¡œ ìë£Œê°€ ìˆœì„œëŒ€ë¡œ ì €ì¥ë¨ì— ë¹„í•´<br />
aëŠ” tranpose ì—°ì‚°ì„ ê±°ì¹˜ë©° axis = 1ì¸ ì•„ë˜ ë°©í–¥ìœ¼ë¡œ ìë£Œê°€ ì €ì¥ë˜ê³  ìˆìŠµë‹ˆë‹¤.<br />
strideë©”ì†Œë“œë¥¼ ë³´ë©´, ë°ì´í„°ì˜ ì €ì¥ ë°©í–¥ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
aì˜ stride ê²°ê³¼ê°’ì„ í•´ì„í•˜ìë©´<br />
a[0][0]-&gt;a[1][0]ìœ¼ë¡œ ì¦ê°€í•  ë•ŒëŠ” ìë£Œ 1ê°œ ë§Œí¼ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ì´ë™ë˜ê³ ,<br />
a[0][0]-&gt;a[0][1]ìœ¼ë¡œ ì¦ê°€í•  ë•ŒëŠ” ìë£Œ 4ê°œ ë§Œí¼ì˜ ë©”ëª¨ë¦¬ ì£¼ì†Œê°€ ë°”ë€ë‹¤ëŠ” ì˜ë¯¸ì…ë‹ˆë‹¤.<br />
ê·¸ë˜ì„œ aì˜ forë¬¸ ê²°ê³¼ì˜ ì²˜ìŒ 3ì¤„ì—ëŠ” ë©”ëª¨ë¦¬ê°€ 16ì”© ì¦ê°€í•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>í˜„ì¬ tranpose ëœ a ê°™ì€ ê²½ìš°ëŠ” contiguousëŠ” Falseë¡œ ìë£Œë¥¼ ìˆœì„œëŒ€ë¡œ ì €ì¥í•˜ê³  ìˆì§€ ì•ŠìŠµë‹ˆë‹¤.<br />
ì´ìƒíƒœì—ì„œ reshape,resizeê°€ ì•„ë‹Œ viewë¥¼ ì¨ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="n">a</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>False



---------------------------------------------------------------------------

RuntimeError                              Traceback (most recent call last)

~\AppData\Local\Temp/ipykernel_26164/2291854614.py in &lt;module&gt;
      1 print(a.is_contiguous())
----&gt; 2 a.view(2,6)


RuntimeError: view size is not compatible with input tensor's size and stride (at least one dimension spans across two contiguous subspaces). Use .reshape(...) instead.
</code></pre></div></div>

<p>ì´ë ‡ê²Œ RuntimeErrorê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê·¸ëŸ¼ aê°€ viewë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ contiguous()ë¥¼ í†µí•´ì„œ ë°”ê¾¸ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">contiguous</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">.</span><span class="n">is_contiguous</span><span class="p">())</span>
<span class="n">a</span><span class="p">.</span><span class="n">view</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True





tensor([[ 1.0009,  0.1026, -1.1214,  0.7532,  2.0344,  1.4519],
        [-0.5742, -1.3162,  1.5134,  1.2349, -1.2356,  1.7235]])
</code></pre></div></div>

<p>í˜„ì¬ëŠ” aê°€ contigious True í˜•íƒœë¡œ ë°”ë€Œì—ˆê³  viewê°€ ì ìš©ë˜ëŠ” ëª¨ìŠµì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê°ì‚¬í•©ë‹ˆë‹¤.</p>

<h3 id="tensor-í•©ì¹˜ê¸°-ë‚˜ëˆ„ê¸°">Tensor í•©ì¹˜ê¸°, ë‚˜ëˆ„ê¸°</h3>

<ul>
  <li>cat, stacking : í…ì„œë¥¼ í•©ì¹©ë‹ˆë‹¤.</li>
  <li>chunk, split : í…ì„œë¥¼ ë‚˜ëˆ ì¤ë‹ˆë‹¤.</li>
</ul>

<p><br /></p>

<h4 id="tensor-í•©ì¹˜ê¸°">Tensor í•©ì¹˜ê¸°</h4>
<p>dimì„ í†µí•´ í•©ì³ì¤„ ì¶•ì„ ì •í•´ì¤ë‹ˆë‹¤.</p>

<p>catì€ ì£¼ì–´ì§„ ì°¨ì›ì„ ê¸°ì¤€ìœ¼ë¡œ, stackì€ ìƒˆë¡œìš´ ì°¨ì›ìœ¼ë¡œ ì£¼ì–´ì§„ í…ì„œë¥¼ ë¶™ì…ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 2.],
        [3., 4.],
        [5., 6.],
        [7., 8.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 2., 5., 6.],
        [3., 4., 7., 8.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[[1., 2.],
         [3., 4.]],

        [[5., 6.],
         [7., 8.]]])
</code></pre></div></div>

<p>catì€ (4,2)ì˜ í¬ê¸°ë¥¼, stackì€ (2,2,2)ì˜ í¬ê¸°ë¥¼ ê°–ëŠ” ê²ƒì„ ì•Œìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">])</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 4.],
        [2., 5.],
        [3., 6.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">([</span><span class="n">x</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">y</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">z</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">0</span><span class="p">)],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 4.],
        [2., 5.],
        [3., 6.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 2., 3.],
        [4., 5., 6.]])
</code></pre></div></div>

<h4 id="tensor-ë‚˜ëˆ„ê¸°">Tensor ë‚˜ëˆ„ê¸°</h4>

<p>chunkëŠ” nê°œì˜ ê·¸ë£¹ì„ ë§Œë“¤ê³ , splitì€ nê°œì˜ ë°ì´í„°ê°€ ìˆëŠ” ê·¸ë£¹ì„ ë§Œë“­ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 3ê°œì˜ ê·¸ë£¹ì„ ë§Œë“œëŠ” chunk
</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>

<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span><span class="p">,</span> <span class="n">t3</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">chunk</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t3</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.3124, 0.3670, 0.4461, 0.3799, 0.4759, 0.7645],
        [0.9245, 0.2099, 0.4981, 0.2253, 0.1432, 0.4176],
        [0.3214, 0.4409, 0.4165, 0.0611, 0.4758, 0.6666]])
tensor([[0.3124, 0.3670],
        [0.9245, 0.2099],
        [0.3214, 0.4409]])
tensor([[0.4461, 0.3799],
        [0.4981, 0.2253],
        [0.4165, 0.0611]])
tensor([[0.4759, 0.7645],
        [0.1432, 0.4176],
        [0.4758, 0.6666]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># 3ê°œì˜ ë°ì´í„°ê°€ ìˆëŠ” ê·¸ë£¹ì„ ë§Œë“œëŠ” split (2ê°œì˜ tensorë¡œ ë¶„ë¦¬)
</span><span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">6</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">)</span>

<span class="n">t1</span><span class="p">,</span> <span class="n">t2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">t1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">t2</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.5875, 0.2308, 0.4805, 0.2589, 0.5313, 0.8857],
        [0.9570, 0.9571, 0.2845, 0.7530, 0.4334, 0.5157],
        [0.6430, 0.3617, 0.3446, 0.9501, 0.4462, 0.8290]])
tensor([[0.5875, 0.2308, 0.4805],
        [0.9570, 0.9571, 0.2845],
        [0.6430, 0.3617, 0.3446]])
tensor([[0.2589, 0.5313, 0.8857],
        [0.7530, 0.4334, 0.5157],
        [0.9501, 0.4462, 0.8290]])
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<hr />

<h2 id="3-tensor-ì—°ì‚°í•˜ê¸°">3. Tensor ì—°ì‚°í•˜ê¸°</h2>

<p>Tensor ê°’ë“¤ë¼ë¦¬ì˜ ì—°ì‚°, Tensorê°„ì˜ ì—°ì‚°ì„ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<p><br /></p>

<h3 id="ê¸°ë³¸-ì—°ì‚°">ê¸°ë³¸ ì—°ì‚°</h3>
<ul>
  <li>+, -, *, / : ê°™ì€ ìœ„ì¹˜ë¼ë¦¬ ì—°ì‚°</li>
  <li>sum, cumsum : í•©ê³¼ ëˆ„ì í•©</li>
  <li>mean, std : í†µê³„ê°’</li>
  <li>exp : ì§€ìˆ˜í•©ìˆ˜</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">8</span><span class="p">])</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">x</span> <span class="o">+</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">/</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">**</span> <span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tensor([ 3.,  4.,  6., 10.]),
 tensor([-1.,  0.,  2.,  6.]),
 tensor([ 2.,  4.,  8., 16.]),
 tensor([0.5000, 1.0000, 2.0000, 4.0000]),
 tensor([ 1.,  4., 16., 64.]))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">==</span> <span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([False,  True, False, False])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(15.)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">exp</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1.6275e+05, 1.6275e+05, 7.3891e+00, 2.0086e+01],
        [5.4598e+01, 1.4841e+02, 4.0343e+02, 1.0966e+03],
        [2.9810e+03, 8.1031e+03, 2.2026e+04, 5.9874e+04]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1, 2, 3],
        [2, 0, 4],
        [3, 4, 5]])
</code></pre></div></div>

<p>axisë¥¼ í†µí•´ ì—°ì‚°í•´ì¤„ í–‰, ì—´ì„ ì§€ì •í•´ì¤ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(torch.Size([3, 3]), tensor([ 6,  6, 12]))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">A</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(torch.Size([3, 3]), tensor([ 6,  6, 12]))
</code></pre></div></div>

<p>keepdimsë¥¼ í†µí•´ ì°¨ì›ì„ ìœ ì§€í•˜ë©° ì—°ì‚°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sum_A</span> <span class="o">=</span> <span class="n">A</span><span class="p">.</span><span class="nb">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">keepdims</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">sum_A</span><span class="p">,</span> <span class="n">sum_A</span><span class="p">.</span><span class="n">shape</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tensor([[ 6],
         [ 6],
         [12]]), torch.Size([3, 1]))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">/</span> <span class="n">sum_A</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.1667, 0.3333, 0.5000],
        [0.3333, 0.0000, 0.6667],
        [0.2500, 0.3333, 0.4167]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span><span class="p">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[ 1,  2,  3],
        [ 3,  2,  7],
        [ 6,  6, 12]])
</code></pre></div></div>

<h3 id="ì •ì¤€--in-place-ì—°ì‚°ì—-ëŒ€í•´-ì•Œë ¤ì£¼ì„¸ìš”">ì •ì¤€ ) in-place ì—°ì‚°ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”</h3>

<p>ìš°ì„  2X2í˜•íƒœì˜ í…ì„œë¥¼ ë§Œë“¤ì–´ ë³€ìˆ˜ xì— ì €ì¥í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">FloatTensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]])</span>
</code></pre></div></div>

<p>ê³±í•˜ê¸° ì—°ì‚°ì„ í•œ ê°’ê³¼ ê¸°ì¡´ì˜ ê°’ì„ ì¶œë ¥í•˜ë©´?</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">mul</span><span class="p">(</span><span class="mf">2.</span><span class="p">))</span> <span class="c1"># ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ ì¶œë ¥
</span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># ê¸°ì¡´ì˜ ê°’ ì¶œë ¥
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    tensor([[2., 4.],
            [6., 8.]])
    tensor([[1., 2.],
            [3., 4.]])
</code></pre></div></div>

<p>ì²«ë²ˆì§¸ ì¶œë ¥ì€ ê³±í•˜ê¸° 2ê°€ ìˆ˜í–‰ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì£¼ê³ , ë‘ë²ˆì§¸ ì¶œë ¥ì€ ê¸°ì¡´ì˜ ê°’ì´ ê·¸ëŒ€ë¡œ ì¶œë ¥ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.<br />
ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í–ˆì§€ë§Œ ì´ë¥¼ xì—ë‹¤ê°€ ë‹¤ì‹œ ì €ì¥í•˜ì§€ ì•Šì•˜ìœ¼ë‹ˆ, ê³±í•˜ê¸° ì—°ì‚°ì„ í•˜ë”ë¼ë„ ê¸°ì¡´ì˜ ê°’ xëŠ” ë³€í•˜ì§€ ì•ŠëŠ” ê²ƒì´ ë‹¹ì—°í•©ë‹ˆë‹¤.</p>

<p>ê·¸ëŸ°ë° ì—°ì‚° ë’¤ì— _ë¥¼ ë¶™ì´ë©´ ì–´ë–»ê²Œ ë ê¹Œìš”? ê¸°ì¡´ì˜ ê°’ì„ ë®ì–´ì“°ê¸° í•©ë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">mul_</span><span class="p">(</span><span class="mf">2.</span><span class="p">))</span>  <span class="c1"># ê³±í•˜ê¸° 2ë¥¼ ìˆ˜í–‰í•œ ê²°ê³¼ë¥¼ ë³€ìˆ˜ xì— ê°’ì„ ì €ì¥í•˜ë©´ì„œ ê²°ê³¼ë¥¼ ì¶œë ¥
</span><span class="k">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="c1"># ê¸°ì¡´ì˜ ê°’ ì¶œë ¥
</span></code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    tensor([[2., 4.],
            [6., 8.]])
    tensor([[2., 4.],
            [6., 8.]])
</code></pre></div></div>

<p>ì´ë ‡ë“¯ xì˜ ê°’ì´ ë®ì–´ ì”Œì›Œì ¸ì„œ 2 ê³±í•˜ê¸° ì—°ì‚°ì´ ëœ ê²°ê³¼ê°€ ì¶œë ¥ë©ë‹ˆë‹¤.<br />
in-place ì—°ì‚°(ì—°ì‚° ë’¤ì— _ë¶™ì´ê¸°)ì„ ì‚¬ìš©í•˜ë©´ ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ ì§€ì •í•˜ì§€ ì•Šì•„ë„ ê¸°ì¡´ ë³€ìˆ˜ì˜ ê°’ì´ ë°”ë€ë‹ˆë‹¤.</p>

<p>ì´ë ‡ë“¯ ê°’ì„ ìì£¼ ì—…ë°ì´íŠ¸ í•´ ì¤˜ì•¼ í•  ë•Œ in-place ì—°ì‚°ì„ ì‚¬ìš©í•œë‹¤ë©´ í¸ë¦¬í•©ë‹ˆë‹¤.<br />
ì˜ˆë¡œ ë“¤ì–´, ì„ í˜• íšŒê·€ êµ¬í˜„ ì‹œ wì™€ bì˜ ê°’ë“¤ì„ ì—…ë°ì´íŠ¸í•  ë•Œ, <br />
in-place ì—°ì‚°ì„ ì¨ì£¼ê²Œ ëœë‹¤ë©´, ìƒˆë¡œìš´ ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒë³´ë‹¤ ì†ë„ë„ ë¹ ë¥´ê³  ì½”ë“œë„ ê°„í¸í•´ì§„ë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤.</p>

<p>í•œê°€ì§€ ì˜ˆì‹œë¥¼ ë” ë“¤ì–´ë³´ê² ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>

<span class="n">a</span><span class="p">.</span><span class="n">add_</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</code></pre></div></div>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    tensor([1., 1., 1., 1., 1.])
    [1. 1. 1. 1. 1.]
    tensor([2., 2., 2., 2., 2.])
    [2. 2. 2. 2. 2.]
</code></pre></div></div>

<h3 id="ì„ í˜•ëŒ€ìˆ˜í•™">ì„ í˜•ëŒ€ìˆ˜í•™</h3>
<p>ì„ í˜•ëŒ€ìˆ˜í•™ì—ì„œ ì‚¬ìš©í•˜ëŠ” ì—°ì‚°ë“¤ì„ ê³µë¶€í–ˆìŠµë‹ˆë‹¤</p>

<ul>
  <li>dot : dot product</li>
  <li>mv, @ : Matrix - Vector product</li>
  <li>mm, @ : Matrix - Matrix product</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">torch</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tensor([0., 1., 2.]), tensor([1., 1., 1.]), tensor(3.))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

<span class="n">A</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">x</span><span class="p">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">torch</span><span class="p">.</span><span class="n">mv</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="n">A</span><span class="o">@</span><span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(torch.Size([2, 3]), torch.Size([3]), tensor([ 5., 14.]), tensor([ 5., 14.]))
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">B</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">mm</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">))</span> 
<span class="k">print</span><span class="p">(</span><span class="n">A</span><span class="o">@</span><span class="n">B</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[ 3.,  3.,  3.,  3.],
        [12., 12., 12., 12.]])
tensor([[ 3.,  3.,  3.,  3.],
        [12., 12., 12., 12.]])
</code></pre></div></div>

<h4 id="norm">Norm</h4>

<p>ë²¡í„°ì˜ í¬ê¸° ë˜ëŠ” ê¸¸ì´ë¥¼ ì¸¡ì •í•˜ëŠ” Normì„ ê³µë¶€í•˜ì˜€ìŠµë‹ˆë‹¤.<br />
L1 Normê³¼ L2 Normì˜ ì‹ë„ ê°„ë‹¨í•˜ê²Œ ì•Œì•„ë³´ì•˜ìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">u</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">4.0</span><span class="p">])</span>
<span class="n">torch</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">u</span><span class="p">)</span> <span class="c1"># L2 Norm
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(5.)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="nb">abs</span><span class="p">(</span><span class="n">u</span><span class="p">).</span><span class="nb">sum</span><span class="p">()</span> <span class="c1"># L1 Norm
</span></code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(7.)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1., 1., 1., 1., 1.],
        [1., 1., 1., 1., 1., 1., 1., 1., 1.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">4</span><span class="p">,</span> <span class="mi">9</span><span class="p">)))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(6.)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(3.7417)
</code></pre></div></div>

<h4 id="autograd">Autograd</h4>

<p>autogradëŠ” íŒŒì´í† ì¹˜ì˜ ìë™ ë¯¸ë¶„ ì—”ì§„ì…ë‹ˆë‹¤. <br />
ë¯¸ë¶„ê°’(gradient)ì„ ìˆ˜ì§‘í•˜ê³  ì €ì¥í•´ì¤ë‹ˆë‹¤.</p>
<ul>
  <li>requires_grad : ì—°ì‚° ì¶”ì  ì—¬ë¶€ë¥¼ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
  <li>backward : ì—­ì „íŒŒ ì‹œì‘</li>
  <li>grad.zero : ê¸°ìš¸ê¸° ì´ˆê¸°í™”</li>
  <li>x.grad : ì €ì¥ëœ ê¸°ìš¸ê¸° ë°˜í™˜</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([0., 1., 2., 3.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">requires_grad_</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
<span class="n">x</span><span class="p">.</span><span class="n">grad</span> 
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">torch</span><span class="p">.</span><span class="n">dot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
<span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(28., grad_fn=&lt;MulBackward0&gt;)
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">grad</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([ 0.,  4.,  8., 12.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">grad</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([True, True, True, True])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="n">zero_</span><span class="p">()</span>  <span class="c1"># Reset the gradient
</span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="nb">sum</span><span class="p">()</span>
<span class="n">y</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">grad</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([1., 1., 1., 1.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">y</span><span class="p">.</span><span class="n">backward</span><span class="p">(</span><span class="n">gradient</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)))</span>  <span class="c1"># Faster: y.sum().backward()
</span><span class="n">x</span><span class="p">.</span><span class="n">grad</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([0., 2., 4., 6.])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">grad</span><span class="p">.</span><span class="n">zero_</span><span class="p">()</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">detach</span><span class="p">()</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">u</span> <span class="o">*</span> <span class="n">x</span>

<span class="n">z</span><span class="p">.</span><span class="nb">sum</span><span class="p">().</span><span class="n">backward</span><span class="p">()</span>
<span class="n">x</span><span class="p">.</span><span class="n">grad</span> <span class="o">==</span> <span class="n">u</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([True, True, True, True])
</code></pre></div></div>

<h3 id="ì—°ìˆ˜--detach-clone-ì—-ëŒ€í•´-ì•Œë ¤ì£¼ì„¸ìš”">ì—°ìˆ˜ ) detach(), clone() ì— ëŒ€í•´ ì•Œë ¤ì£¼ì„¸ìš”.</h3>

<h4 id="tensorë¥¼-ë³µì‚¬í•˜ëŠ”-ë°©ë²•">Tensorë¥¼ ë³µì‚¬í•˜ëŠ” ë°©ë²•</h4>

<h5 id="1-detach--ê¸°ì¡´-tensorì—ì„œ-gradient-ì „íŒŒê°€-ì•ˆë˜ëŠ”-í…ì„œ-ìƒì„±">1. detach() : ê¸°ì¡´ Tensorì—ì„œ gradient ì „íŒŒê°€ ì•ˆë˜ëŠ” í…ì„œ ìƒì„±</h5>
<h5 id="2-clone---ê¸°ì¡´-tensorì™€-ë‚´ìš©ì„-ë³µì‚¬í•œ-í…ì„œ-ìƒì„±">2. clone() :  ê¸°ì¡´ Tensorì™€ ë‚´ìš©ì„ ë³µì‚¬í•œ í…ì„œ ìƒì„±</h5>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">a</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">detach</span><span class="p">()</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">a</span><span class="p">.</span><span class="n">clone</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="n">c</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398]) tensor([-0.0803, -0.1637, -0.0640, -0.4010, -0.9398])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">a</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([ 1.0000, -0.1637, -0.0640, -0.4010, -0.9398])
</code></pre></div></div>

<p>bë¥¼ ë³€ê²½í•˜ì aë„ ë³€í•œê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">c</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([ 2.0000, -0.1637, -0.0640, -0.4010, -0.9398]) tensor([ 1.0000, -0.1637, -0.0640, -0.4010, -0.9398])
</code></pre></div></div>

<p>clone()í•œ tensorëŠ” ê°’ì´ ë³€ê²½ë˜ì–´ë„ ì›ë˜ tensor ê°’ì´ ë³€í•˜ì§€ ì•ŠëŠ”ë‹¤</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<hr />

<h2 id="4-dataframeì„-tensorë¡œ-ë§Œë“¤ê¸°">4. DataFrameì„ Tensorë¡œ ë§Œë“¤ê¸°</h2>

<p>torch.tensorì„ í†µí•´ ë°ì´í„°í”„ë ˆì„ í˜•íƒœë„ Tensorë¡œ ë§Œë“¤ì–´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">os</span>

<span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">'..'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">),</span> <span class="n">exist_ok</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">data_file</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="s">'..'</span><span class="p">,</span> <span class="s">'data'</span><span class="p">,</span> <span class="s">'house_tiny.csv'</span><span class="p">)</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">data_file</span><span class="p">,</span> <span class="s">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">'''NumRooms,RoofType,Price
NA,NA,127500
2,NA,106000
4,Slate,178100
NA,NA,140000'''</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">data_file</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   NumRooms RoofType   Price
0       NaN      NaN  127500
1       2.0      NaN  106000
2       4.0    Slate  178100
3       NaN      NaN  140000
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">],</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">dummy_na</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   NumRooms  RoofType_Slate  RoofType_nan
0       NaN               0             1
1       2.0               0             1
2       4.0               1             0
3       NaN               0             1
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   NumRooms  RoofType_Slate  RoofType_nan
0       3.0               0             1
1       2.0               0             1
2       4.0               1             0
3       3.0               0             1
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">values</span><span class="p">),</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">targets</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tensor([[3., 0., 1.],
         [2., 0., 1.],
         [4., 1., 0.],
         [3., 0., 1.]], dtype=torch.float64),
 tensor([127500, 106000, 178100, 140000]))
</code></pre></div></div>

<h3 id="ì¬ì˜--array---tensor-ê°„-ë³€í™˜-ë°©ë²•ì„-ì•Œë ¤ì£¼ì„¸ìš”">ì¬ì˜ ) Array - Tensor ê°„ ë³€í™˜ ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”.</h3>

<p>Pytorchì—ì„œ numpy arrayë¥¼ Tensor ìë£Œí˜•ìœ¼ë¡œ ë°”ê¾¸ê¸° ìœ„í•´ì„œëŠ” <code class="language-plaintext highlighter-rouge">torch.Tensor()</code>ì™€ <code class="language-plaintext highlighter-rouge">torch.from_numpy()</code>ë¥¼ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ë¨¼ì €, <code class="language-plaintext highlighter-rouge">torch.Tensor()</code> ë¥¼ <a href="https://pytorch.org/docs/stable/tensors.html">pytorch ê³µì‹ ë¬¸ì„œ</a>ì—ì„œ í™•ì¸í•´ë³¸ë‹¤ë©´ ë§ê·¸ëŒ€ë¡œ Tensorë¥¼ ë§Œë“¤ì–´ë‚´ëŠ” êµ¬ë¬¸ì´ê¸° ë•Œë¬¸ì— ë‚˜ì™€ ìˆëŠ” ì˜ˆì‹œì—ëŠ” arrayê°€ ì§ì ‘ ë“¤ì–´ê°€ ìˆëŠ” ê²½ìš°ë¥¼ ë§ì´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ê·¸ë¦¬ê³  ì•„ë˜ì™€ ê°™ì´ ìƒì„±ë˜ëŠ” Tensorì˜ ë°ì´í„° íƒ€ì…ë§ˆë‹¤ ì–´ë– í•œ êµ¬ë¬¸ì„ ì¨ì•¼í•˜ëŠ”ì§€ ë‚˜íƒ€ë‚˜ ìˆìŠµë‹ˆë‹¤. ì•„ë˜ì˜ ì´ë¯¸ì§€ëŠ” ê·¸ ì¤‘ ì¼ë¶€ë¥¼ ë°œì·Œí•œ ê²ƒì…ë‹ˆë‹¤.</p>

<div align="center"> <img src="https://drive.google.com/uc?id=14E34d4n2UhkkVNlCL0EanexuC8gS_hyL" /> </div>

<p>ë˜í•œ, <code class="language-plaintext highlighter-rouge">torch.from_numpy()</code> ë¥¼ <a href="&quot;https://pytorch.org/docs/stable/generated/torch.from_numpy.html&quot;">pytorch ê³µì‹ ë¬¸ì„œ</a>ì—ì„œ í™•ì¸í•´ë³¸ë‹¤ë©´ <code class="language-plaintext highlighter-rouge">Creates a Tensor from a numpy.ndarray</code> ë¼ê³  ì„¤ëª…ë˜ì–´ ìˆëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë§ ê·¸ëŒ€ë¡œ numpyë¡œ ë§Œë“¤ì–´ì§„ arrayë¥¼ tensorë¡œ ë§Œë“¤ì–´ì£¼ëŠ” ì—­í• ì„ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<div align="center"> <img src="https://drive.google.com/uc?id=1DGSJhwGKGAkVUm478YmIRP25nhycTbHj" /> </div>

<p>ë‹¤ë§Œ, ì£¼ì˜í•´ì•¼í•  ì ì€ ë§Œë“¤ì–´ì§„ tensorëŠ” ê¸°ì¡´ì˜ ndarrayì™€ ë™ì¼í•œ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•œë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ê·¸ë ‡ê¸°ì— tensorì— ëŒ€í•œ ìˆ˜ì • ì‚¬í•­ì´ ndarrayì— ë°˜ì˜ë˜ê³ , ê·¸ ë°˜ëŒ€ì˜ ê²½ìš° ë˜í•œ ì ìš©ëœë‹¤ëŠ” ì ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤.</p>

<p>ë˜í•œ, ê·¸ë¡œ ì¸í•´ ë§Œë“¤ì–´ì§„ tensorì˜ í¬ê¸°ëŠ” ê·¸ ì´í›„ ì¡°ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì´ì™€ ê´€ë ¨ëœ ê³µì‹ ë¬¸ì„œì˜ ì„¤ëª…ì€ ì•„ë˜ì™€ ê°™ìŠµë‹ˆë‹¤.</p>

<div align="center"> <img src="https://drive.google.com/uc?id=1VfaE2osqXmezYhioaXN2kLW8VzBCjk4u" /> </div>

<p>ê·¸ë ‡ë‹¤ë©´ ì •ë§ ì‘ë™í•˜ëŠ”ì§€ í™•ì¸í•´ë´…ì‹œë‹¤.</p>

<p>ë¨¼ì €, <code class="language-plaintext highlighter-rouge">torch.Tensor()</code> í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ numpy arrayë¥¼ Tensorë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">arr</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr</span><span class="p">))</span>

<span class="n">arr_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">arr</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr_tensor</span><span class="p">))</span>
</code></pre></div></div>

<p>ì•„ë˜ì™€ ê°™ì´ í•´ë‹¹í•˜ëŠ” typeì´ ë³€ê²½ë˜ëŠ” ê²ƒì„ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div align="center"> <img src="https://drive.google.com/uc?id=1Wk4zEELWdLsoaOuf-ruHm1Q-V7-I0HEo" /> </div>

<p>ë‹¤ìŒìœ¼ë¡œëŠ” <code class="language-plaintext highlighter-rouge">torch.from_numpy()</code> í•¨ìˆ˜ë¥¼ í™œìš©í•˜ì—¬ numpy arrayë¥¼ Tensorë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">arr2</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr2</span><span class="p">))</span>

<span class="n">arr_tensor2</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">arr2</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr_tensor2</span><span class="p">))</span>
</code></pre></div></div>

<p>ì•„ë˜ì™€ ê°™ì´ í•´ë‹¹í•˜ëŠ” typeì´ ë³€í™˜ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div align="center"><img src="https://drive.google.com/uc?id=1Wk4zEELWdLsoaOuf-ruHm1Q-V7-I0HEo" /></div>

<p>ì´ì™€ ë°˜ëŒ€ë¡œ Pytorchì—ì„œ tensorì—ì„œ numpyë¡œ ë³€ê²½í•˜ê¸° ìœ„í•´ì„œëŠ” <code class="language-plaintext highlighter-rouge">torch.Tensor.numpy()</code> êµ¬ë¬¸ì„ í™œìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì´ë¥¼ <a href="https://pytorch.org/docs/stable/generated/torch.Tensor.numpy.html">pytorch ê³µì‹ë¬¸ì„œ</a>ì—ì„œ í™•ì¸í•´ë³´ë©´ ì•„ë˜ì™€ ê°™ì´ ê°„ê²°í•˜ê²Œ ì—­í• ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<p>ì•ì„  <code class="language-plaintext highlighter-rouge">torch.from_numpy()</code> ì™€ ë§ˆì°¬ê°€ì§€ë¡œ <code class="language-plaintext highlighter-rouge">torch.Tensor.numpy()</code> ë˜í•œ ê° tensorì™€ ndarrayëŠ” ê°™ì€ ë©”ëª¨ë¦¬ë¥¼ ê³µìœ í•˜ê²Œ ë©ë‹ˆë‹¤.</p>

<div align="center"> <img src="https://drive.google.com/uc?id=1OGc3E3BBM3DjMMeanVGkkiEGV0v0BgKB" /> </div>

<p>ì´ì œëŠ” <code class="language-plaintext highlighter-rouge">numpy()</code> ë¥¼ í™œìš©í•˜ì—¬ ë³€í™˜ëœ Tensorë¥¼ numpy arrayë¡œ ë°”ê¾¸ì–´ë´…ì‹œë‹¤.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="n">arr_numpy</span> <span class="o">=</span> <span class="n">arr_tensor</span><span class="p">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">arr_numpy</span><span class="p">))</span>
</code></pre></div></div>

<p>ì•„ë˜ì™€ ê°™ì´ <code class="language-plaintext highlighter-rouge">numpy.ndarray</code> íƒ€ì…ìœ¼ë¡œ ë³€í™˜ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>

<div align="center"><img src="https://drive.google.com/uc?id=1p-YqWDZnsikTgAA67YuSpayk6Ko2Qtvo" /></div>

<p><br />
<br />
<br /></p>

<hr />

<h2 id="5-ì‹¤ìŠµ">5. ì‹¤ìŠµ</h2>

<p>ì˜¤ëŠ˜ ë°°ìš´ ë‚´ìš©ì„ ì§ì ‘ íƒ€ì´í•‘í•´ë³´ëŠ” ì‹œê°„ë„ ê°€ì¡ŒìŠµë‹ˆë‹¤!<br />
ì‹œê°„ì´ ì—¬ìœ ë¡­ì§€ì•Šì•„ ì™„ë²½í•˜ê²ŒëŠ” ëª»í–ˆì§€ë§Œ ë‹¤ìŒë²ˆì—ëŠ” ë” ë‚˜ì€ ì‹¤ìŠµë“¤ë¡œ ë§ˆë ¨í•´ë³¼ê²Œìš” ğŸ’¯</p>

<h4 id="1-23-í˜•íƒœì˜-01-ì‚¬ì´ì˜-ë¬´ì‘ìœ„-ê°’ìœ¼ë¡œ-ì´ë£¨ì–´ì§„-í…ì„œë¥¼-ìƒì„±í•´ë³´ì„¸ìš”">1. (2,3) í˜•íƒœì˜ 0~1 ì‚¬ì´ì˜ ë¬´ì‘ìœ„ ê°’ìœ¼ë¡œ ì´ë£¨ì–´ì§„ í…ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[-1.1449e+00, -5.8245e-01, -4.2747e-01],
        [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])
</code></pre></div></div>

<h4 id="2-ìœ„-í…ì„œì˜-íƒ€ì…ì„-ì¶œë ¥í•´ë³´ì„¸ìš”dtype">2. ìœ„ í…ì„œì˜ íƒ€ì…ì„ ì¶œë ¥í•´ë³´ì„¸ìš”.(dtype)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="p">.</span><span class="n">dtype</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>torch.float32
</code></pre></div></div>

<h4 id="3-1ë¶€í„°-3ê¹Œì§€-ìˆœì„œëŒ€ë¡œ-ì´ë£¨ì–´ì§„-int-typeì˜-í…ì„œë¥¼-ìƒì„±í•´ë³´ì„¸ìš”">3. 1ë¶€í„° 3ê¹Œì§€ ìˆœì„œëŒ€ë¡œ ì´ë£¨ì–´ì§„ int typeì˜ í…ì„œë¥¼ ìƒì„±í•´ë³´ì„¸ìš”.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">int64</span><span class="p">)</span>
<span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([1, 2, 3])
</code></pre></div></div>

<h4 id="4-ì²«ë²ˆì§¸-ìƒì„±í•œ-í…ì„œì™€-ë‘ë²ˆì§¸-ìƒì„±í•œ-í…ì„œì˜-ê³±ì„-í•˜ê³ -ì—°ì‚°ì´-ë˜ëŠ”-ì´ìœ ëŠ”-ë¬´ì—‡ì¸ê°€ìš”">4. ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œì™€ ë‘ë²ˆì§¸ ìƒì„±í•œ í…ì„œì˜ ê³±ì„ í•˜ê³  ì—°ì‚°ì´ ë˜ëŠ” ì´ìœ ëŠ” ë¬´ì—‡ì¸ê°€ìš”?</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span><span class="o">*</span><span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[-1.1449e+00, -1.1649e+00, -1.2824e+00],
        [ 2.1382e-05, -5.0074e-01,  3.9180e-01]])
</code></pre></div></div>

<h4 id="5-ì²«ë²ˆì§¸-ìƒì„±í•œ-í…ì„œë¥¼-transposeí•˜ê³ -ì²«ë²ˆì§¸-ìƒì„±í•œ-í…ì„œì™€-í–‰ë ¬ê³±ì„-ì§„í–‰í•´ë³´ì„¸ìš”">5. ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œë¥¼ Transposeí•˜ê³  ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œì™€ í–‰ë ¬ê³±ì„ ì§„í–‰í•´ë³´ì„¸ìš”</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">T</span>
<span class="n">z</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[-1.1449e+00,  2.1382e-05],
        [-5.8245e-01, -2.5037e-01],
        [-4.2747e-01,  1.3060e-01]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z</span><span class="o">@</span><span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1.3107, 0.6668, 0.4894],
        [0.6668, 0.4019, 0.2163],
        [0.4894, 0.2163, 0.1998]])
</code></pre></div></div>

<h4 id="6-í–‰ë ¬ê³±ì„-ì§„í–‰í•œ-í…ì„œì™€-ì²«ë²ˆì§¸-ìƒì„±í•œ-í…ì„œë¥¼-concatenateí•˜ì„¸ìš”">6. í–‰ë ¬ê³±ì„ ì§„í–‰í•œ í…ì„œì™€ ì²«ë²ˆì§¸ ìƒì„±í•œ í…ì„œë¥¼ Concatenateí•˜ì„¸ìš”</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">x</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[-1.1449e+00, -5.8245e-01, -4.2747e-01],
        [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">torch</span><span class="p">.</span><span class="n">cat</span><span class="p">([</span><span class="n">z</span><span class="o">@</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[ 1.3107e+00,  6.6682e-01,  4.8940e-01],
        [ 6.6682e-01,  4.0193e-01,  2.1628e-01],
        [ 4.8940e-01,  2.1628e-01,  1.9979e-01],
        [-1.1449e+00, -5.8245e-01, -4.2747e-01],
        [ 2.1382e-05, -2.5037e-01,  1.3060e-01]])
</code></pre></div></div>

<h4 id="7-ë‘ë²ˆì§¸ì—-ë§Œë“ -í…ì„œë¥¼-unsqueezeí•˜ê³ -shapeë¥¼-ì¶œë ¥í•˜ì„¸ìš”-dim1">7. ë‘ë²ˆì§¸ì— ë§Œë“  í…ì„œë¥¼ unsqueezeí•˜ê³  shapeë¥¼ ì¶œë ¥í•˜ì„¸ìš” (dim=1)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[1],
        [2],
        [3]])
torch.Size([3, 1])
</code></pre></div></div>

<h4 id="8-unsqueezeí•œ-í…ì„œë¥¼-squeezeí•˜ì„¸ìš”-shapeë¥¼-ì¶œë ¥í•˜ì„¸ìš”-dim1">8. unsqueezeí•œ í…ì„œë¥¼ squeezeí•˜ì„¸ìš” shapeë¥¼ ì¶œë ¥í•˜ì„¸ìš” (dim=1)</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">k</span> <span class="o">=</span> <span class="n">y</span><span class="p">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">print</span><span class="p">(</span><span class="n">k</span><span class="p">.</span><span class="n">squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">).</span><span class="n">shape</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([1, 2, 3])
torch.Size([3])
</code></pre></div></div>

<h4 id="9-0ë¶€í„°-5ì˜-ìˆ«ìë¡œ-ì´ë£¨ì–´ì§„-23í˜•íƒœì˜-í…ì„œê³ -normì„-êµ¬í•´ì£¼ì„¸ìš”">9. 0ë¶€í„° 5ì˜ ìˆ«ìë¡œ ì´ë£¨ì–´ì§„ (2,3)í˜•íƒœì˜ í…ì„œê³  Normì„ êµ¬í•´ì£¼ì„¸ìš”</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">A</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="p">.</span><span class="n">float32</span><span class="p">).</span><span class="n">reshape</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">A</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0., 1., 2.],
        [3., 4., 5.]])
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">torch</span><span class="p">.</span><span class="n">norm</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor(7.4162)
</code></pre></div></div>

<h4 id="10-í•´ë‹¹-ì½”ë“œê°€-ëŒì•„ê°€ë„ë¡-ì•Œë§ì€-íŒŒë¼ë¯¸í„°ë¥¼-ì¶”ê°€í•´ì£¼ì„¸ìš”">10. í•´ë‹¹ ì½”ë“œê°€ ëŒì•„ê°€ë„ë¡ ì•Œë§ì€ íŒŒë¼ë¯¸í„°ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”!</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">torch</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># input tensor
</span><span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># expected output
</span><span class="n">w</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">requires_grad</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">nn</span><span class="p">.</span><span class="n">functional</span><span class="p">.</span><span class="n">binary_cross_entropy_with_logits</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Gradient function for z = </span><span class="si">{</span><span class="n">z</span><span class="p">.</span><span class="n">grad_fn</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="sa">f</span><span class="s">"Gradient function for loss = </span><span class="si">{</span><span class="n">loss</span><span class="p">.</span><span class="n">grad_fn</span><span class="si">}</span><span class="s">"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Gradient function for z = &lt;AddBackward0 object at 0x7f5523e0a210&gt;
Gradient function for loss = &lt;BinaryCrossEntropyWithLogitsBackward0 object at 0x7f5523e0a5d0&gt;
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">loss</span><span class="p">.</span><span class="n">backward</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">w</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">b</span><span class="p">.</span><span class="n">grad</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>tensor([[0.0139, 0.3273, 0.0794],
        [0.0139, 0.3273, 0.0794],
        [0.0139, 0.3273, 0.0794],
        [0.0139, 0.3273, 0.0794],
        [0.0139, 0.3273, 0.0794]])
tensor([0.0139, 0.3273, 0.0794])
</code></pre></div></div>

<h4 id="11-ì•„ë˜-falseê°€-ë‚˜ì˜¨-ê²°ê³¼ì™€-ê°™ì€-ê²°ê³¼ê°€-ë‚˜ì˜¤ë„ë¡-ì½”ë“œë¥¼-ì™„ì„±í•´ì£¼ì„¸ìš”">11. ì•„ë˜ Falseê°€ ë‚˜ì˜¨ ê²°ê³¼ì™€ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ë„ë¡ ì½”ë“œë¥¼ ì™„ì„±í•´ì£¼ì„¸ìš”.</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
<span class="k">print</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="n">requires_grad</span><span class="p">)</span>

<span class="k">with</span> <span class="n">torch</span><span class="p">.</span><span class="n">no_grad</span><span class="p">():</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
<span class="k">print</span><span class="p">(</span><span class="n">z</span><span class="p">.</span><span class="n">requires_grad</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>True
False
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">z</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">w</span><span class="p">)</span><span class="o">+</span><span class="n">b</span>
<span class="n">z_det</span> <span class="o">=</span> <span class="n">z</span><span class="p">.</span><span class="n">detach</span><span class="p">()</span>
<span class="k">print</span><span class="p">(</span><span class="n">z_det</span><span class="p">.</span><span class="n">requires_grad</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>False
</code></pre></div></div>

<h4 id="12-ì½”ë©-sample-dataì˜-california_housing_trainì—ì„œ-median_house_valueë¥¼-targetìœ¼ë¡œ-í•˜ê³ -tensorí˜•íƒœë¡œ-ë³€í™˜í•´ë³´ì„¸ìš”">12. ì½”ë© Sample dataì˜ california_housing_trainì—ì„œ median_house_valueë¥¼ targetìœ¼ë¡œ í•˜ê³  Tensorí˜•íƒœë¡œ ë³€í™˜í•´ë³´ì„¸ìš”</h4>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">'/content/sample_data/california_housing_train.csv'</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>       longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
0        -114.31     34.19                15.0       5612.0          1283.0   
1        -114.47     34.40                19.0       7650.0          1901.0   
2        -114.56     33.69                17.0        720.0           174.0   
3        -114.57     33.64                14.0       1501.0           337.0   
4        -114.57     33.57                20.0       1454.0           326.0   
...          ...       ...                 ...          ...             ...   
16995    -124.26     40.58                52.0       2217.0           394.0   
16996    -124.27     40.69                36.0       2349.0           528.0   
16997    -124.30     41.84                17.0       2677.0           531.0   
16998    -124.30     41.80                19.0       2672.0           552.0   
16999    -124.35     40.54                52.0       1820.0           300.0   

       population  households  median_income  median_house_value  
0          1015.0       472.0         1.4936             66900.0  
1          1129.0       463.0         1.8200             80100.0  
2           333.0       117.0         1.6509             85700.0  
3           515.0       226.0         3.1917             73400.0  
4           624.0       262.0         1.9250             65500.0  
...           ...         ...            ...                 ...  
16995       907.0       369.0         2.3571            111400.0  
16996      1194.0       465.0         2.5179             79000.0  
16997      1244.0       456.0         3.0313            103600.0  
16998      1298.0       478.0         1.9797             85800.0  
16999       806.0       270.0         3.0147             94600.0  

[17000 rows x 9 columns]
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">data</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['longitude', 'latitude', 'housing_median_age', 'total_rooms',
       'total_bedrooms', 'population', 'households', 'median_income',
       'median_house_value'],
      dtype='object')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span> <span class="o">=</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">data</span><span class="p">.</span><span class="n">iloc</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">dummy_na</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
0    -114.31     34.19                15.0       5612.0          1283.0   
1    -114.47     34.40                19.0       7650.0          1901.0   
2    -114.56     33.69                17.0        720.0           174.0   
3    -114.57     33.64                14.0       1501.0           337.0   
4    -114.57     33.57                20.0       1454.0           326.0   

   population  households  median_income  
0      1015.0       472.0         1.4936  
1      1129.0       463.0         1.8200  
2       333.0       117.0         1.6509  
3       515.0       226.0         3.1917  
4       624.0       262.0         1.9250  
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">inputs</span> <span class="o">=</span> <span class="n">inputs</span><span class="p">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">mean</span><span class="p">())</span>
<span class="k">print</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">head</span><span class="p">())</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>   longitude  latitude  housing_median_age  total_rooms  total_bedrooms  \
0    -114.31     34.19                15.0       5612.0          1283.0   
1    -114.47     34.40                19.0       7650.0          1901.0   
2    -114.56     33.69                17.0        720.0           174.0   
3    -114.57     33.64                14.0       1501.0           337.0   
4    -114.57     33.57                20.0       1454.0           326.0   

   population  households  median_income  
0      1015.0       472.0         1.4936  
1      1129.0       463.0         1.8200  
2       333.0       117.0         1.6509  
3       515.0       226.0         3.1917  
4       624.0       262.0         1.9250  
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">inputs</span><span class="p">.</span><span class="n">values</span><span class="p">),</span> <span class="n">torch</span><span class="p">.</span><span class="n">tensor</span><span class="p">(</span><span class="n">targets</span><span class="p">.</span><span class="n">values</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>(tensor([[-114.3100,   34.1900,   15.0000,  ..., 1015.0000,  472.0000,
             1.4936],
         [-114.4700,   34.4000,   19.0000,  ..., 1129.0000,  463.0000,
             1.8200],
         [-114.5600,   33.6900,   17.0000,  ...,  333.0000,  117.0000,
             1.6509],
         ...,
         [-124.3000,   41.8400,   17.0000,  ..., 1244.0000,  456.0000,
             3.0313],
         [-124.3000,   41.8000,   19.0000,  ..., 1298.0000,  478.0000,
             1.9797],
         [-124.3500,   40.5400,   52.0000,  ...,  806.0000,  270.0000,
             3.0147]], dtype=torch.float64),
 tensor([ 66900.,  80100.,  85700.,  ..., 103600.,  85800.,  94600.],
        dtype=torch.float64))
</code></pre></div></div>

<p><br />
<br />
<br /></p>

<hr />

<h2 id="6-ë§ˆì¹˜ë©°">6. ë§ˆì¹˜ë©°</h2>

<p>ë„ˆë¬´ ë§ì€ ë‚´ìš©ì„ í–ˆì—ˆë˜ 2ì£¼ì°¨ì˜€ìŠµë‹ˆë‹¤!!<br />
Tensorë¥¼ ì–´ë–¤ ì‹ìœ¼ë¡œ ë§Œì§€ê³  ë³€ê²½í•  ìˆ˜ ìˆëŠ”ì§€ ì•Œê²Œë˜ëŠ” 2ì£¼ì°¨ì˜€ìœ¼ë©´ ì¢‹ê² ìŠµë‹ˆë‹¤!</p>

  </article>
  <br>

  <hr/><br>

  <div class="author">
    
    <table>
        <tr>
          <td rowspan="3" style="padding-right: 10px"><img class="author-pic" src="https://github.com/.png" alt=""></td>
          <td><b><h2 rel="author"></h2></b></td>
        </tr>
      <tr>
        <td><p rel="author"></p>
        </td>
      </tr>
      <tr>
        <td>
          <a rel="author" href="https://github.com/" target="_blank"><i class="fa fa-github fa-2x"></i></a>&nbsp&nbsp
          
        </td>
      </tr>
    </table>

  </div>


  <br>
  <hr/>
  <div>
    <script src="https://utteranc.es/client.js"
        repo="gdsc-seoultech/blog-comments"
        issue-term="pathname"
        label="comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
    </script>
  </div>

</div>
<script src="/js/toc.js"></script>
      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper" align="center">
  	<h4>This site was built using <a href="http://jekyllrb.com" target="_blank">Jekyll</a> and is hosted on <a href="https://github.com" target="_blank">Github</a>. &#169; GDSC Seoultech</h4>
  </div>

</footer>


  </body>
</html>
